Sender: LSF System <lsfadmin@eu-g3-016>
Subject: Job 205633399: <w103_size_0.5_fp16_label_smoothing_0.02_#1> in cluster <euler> Exited

Job <w103_size_0.5_fp16_label_smoothing_0.02_#1> was submitted from host <eu-login-37> by user <andriusb> in cluster <euler> at Fri Feb 18 08:23:03 2022
Job was executed on host(s) <eu-g3-016>, in queue <gpu.24h>, as user <andriusb> in cluster <euler> at Fri Feb 18 08:23:17 2022
</cluster/home/andriusb> was used as the home directory.
</cluster/home/andriusb/fq/fairseq> was used as the working directory.
Started at Fri Feb 18 08:23:17 2022
Terminated at Sun Feb 20 07:28:08 2022
Results reported at Sun Feb 20 07:28:08 2022

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
CUDA_VISIBLE_DEVICES=0 fairseq-train --task language_modeling data-bin/wikitext-103-raw-size-0.5 --save-dir /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1 --arch transformer_lm --share-decoder-input-output-embed --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.02 --optimizer adam --adam-betas "(0.9, 0.98)" --weight-decay 0.01 --clip-norm 0.0 --lr 0.0005 --lr-scheduler inverse_sqrt --warmup-updates 4000 --warmup-init-lr 1e-07 --tokens-per-sample 512 --sample-break-mode none --max-tokens 512 --update-freq 128 --seed 1321671 --fp16 --max-update 50000
------------------------------------------------------------

Exited with exit code 134.

Resource usage summary:

    CPU time :                                   166643.33 sec.
    Max Memory :                                 13828 MB
    Average Memory :                             3378.96 MB
    Total Requested Memory :                     20000.00 MB
    Delta Memory :                               6172.00 MB
    Max Swap :                                   311 MB
    Max Processes :                              4
    Max Threads :                                14
    Run time :                                   169491 sec.
    Turnaround time :                            169505 sec.

The output (if any) follows:

2022-02-18 08:23:24 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 100, 'log_format': None, 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1321671, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 1, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': 512, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 512, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [128], 'lr': [0.0005], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': '/cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'transformer_lm', 'activation_fn': 'relu', 'dropout': 0.1, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'relu_dropout': 0.0, 'decoder_embed_dim': 512, 'decoder_output_dim': 512, 'decoder_input_dim': 512, 'decoder_ffn_embed_dim': 2048, 'decoder_layers': 6, 'decoder_attention_heads': 8, 'decoder_normalize_before': False, 'no_decoder_final_norm': False, 'adaptive_softmax_cutoff': None, 'adaptive_softmax_dropout': 0.0, 'adaptive_softmax_factor': 4.0, 'no_token_positional_embeddings': False, 'share_decoder_input_output_embed': True, 'character_embeddings': False, 'character_filters': '[(1, 64), (2, 128), (3, 192), (4, 256), (5, 256), (6, 256), (7, 256)]', 'character_embedding_dim': 4, 'char_embedder_highway_layers': 2, 'adaptive_input': False, 'adaptive_input_factor': 4.0, 'adaptive_input_cutoff': None, 'tie_adaptive_weights': False, 'tie_adaptive_proj': False, 'decoder_learned_pos': False, 'layernorm_embedding': False, 'no_scale_embedding': False, 'checkpoint_activations': False, 'offload_activations': False, 'decoder_layerdrop': 0.0, 'decoder_layers_to_keep': None, 'quant_noise_pq': 0.0, 'quant_noise_pq_block_size': 8, 'quant_noise_scalar': 0.0, 'min_params_to_wrap': 100000000, 'base_layers': 0, 'base_sublayers': 1, 'base_shuffle': 1, 'scale_fc': False, 'scale_attn': False, 'scale_heads': False, 'scale_resids': False, 'add_bos_token': False, 'tokens_per_sample': 512, 'max_target_positions': None, 'tpu': False}, 'task': {'_name': 'language_modeling', 'data': 'data-bin/wikitext-103-raw-size-0.5', 'sample_break_mode': 'none', 'tokens_per_sample': 512, 'output_dictionary_size': -1, 'self_target': False, 'future_target': False, 'past_target': False, 'add_bos_token': False, 'max_target_positions': None, 'shorten_method': 'none', 'shorten_data_split_list': '', 'pad_to_fixed_length': False, 'pad_to_fixed_bsz': False, 'seed': 1321671, 'batch_size': None, 'batch_size_valid': None, 'dataset_impl': None, 'data_buffer_size': 10, 'tpu': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'criterion': {'_name': 'label_smoothed_cross_entropy', 'label_smoothing': 0.02, 'report_accuracy': False, 'ignore_prefix_size': 0, 'sentence_avg': False}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0005]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 4000, 'warmup_init_lr': 1e-07, 'lr': [0.0005]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2022-02-18 08:23:25 | INFO | fairseq.tasks.language_modeling | dictionary: 430640 types
2022-02-18 08:23:30 | INFO | fairseq_cli.train | TransformerLanguageModel(
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(430640, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (output_projection): Linear(in_features=512, out_features=430640, bias=False)
  )
)
2022-02-18 08:23:30 | INFO | fairseq_cli.train | task: LanguageModelingTask
2022-02-18 08:23:30 | INFO | fairseq_cli.train | model: TransformerLanguageModel
2022-02-18 08:23:30 | INFO | fairseq_cli.train | criterion: LabelSmoothedCrossEntropyCriterion
2022-02-18 08:23:30 | INFO | fairseq_cli.train | num. shared model params: 239,401,984 (num. trained: 239,401,984)
2022-02-18 08:23:30 | INFO | fairseq_cli.train | num. expert model params: 0 (num. trained: 0)
2022-02-18 08:23:30 | INFO | fairseq.data.data_utils | loaded 3,760 examples from: data-bin/wikitext-103-raw-size-0.5/valid
2022-02-18 08:23:33 | INFO | fairseq.trainer | detected shared parameter: decoder.embed_tokens.weight <- decoder.output_projection.weight
2022-02-18 08:23:33 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-02-18 08:23:33 | INFO | fairseq.utils | rank   0: capabilities =  7.5  ; total memory = 10.761 GB ; name = NVIDIA GeForce RTX 2080 Ti              
2022-02-18 08:23:33 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2022-02-18 08:23:33 | INFO | fairseq_cli.train | training on 1 devices (GPUs/TPUs)
2022-02-18 08:23:33 | INFO | fairseq_cli.train | max tokens per device = 512 and max sentences per device = None
2022-02-18 08:23:33 | INFO | fairseq.trainer | Preparing to load checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint_last.pt
2022-02-18 08:23:33 | INFO | fairseq.trainer | No existing checkpoint found /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint_last.pt
2022-02-18 08:23:33 | INFO | fairseq.trainer | loading train data for epoch 1
2022-02-18 08:23:34 | INFO | fairseq.data.data_utils | loaded 900,675 examples from: data-bin/wikitext-103-raw-size-0.5/train
2022-02-18 08:23:35 | INFO | fairseq.trainer | begin training epoch 1
2022-02-18 08:23:35 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 08:23:46 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-02-18 08:23:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 08:24:07 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 08:24:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-18 08:34:09 | INFO | train_inner | epoch 001:    104 / 788 loss=17.404, nll_loss=17.362, ppl=168432, wps=11170.3, ups=0.17, wpb=65536, bsz=128, num_updates=100, lr=1.25975e-05, gnorm=3.317, loss_scale=8, train_wall=611, gb_free=3.3, wall=636
2022-02-18 08:36:59 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-18 08:44:06 | INFO | train_inner | epoch 001:    205 / 788 loss=15.042, nll_loss=14.952, ppl=31694.9, wps=10981, ups=0.17, wpb=65536, bsz=128, num_updates=200, lr=2.5095e-05, gnorm=1.624, loss_scale=8, train_wall=573, gb_free=3.3, wall=1233
2022-02-18 08:53:57 | INFO | train_inner | epoch 001:    305 / 788 loss=12.786, nll_loss=12.644, ppl=6400.04, wps=11090.7, ups=0.17, wpb=65536, bsz=128, num_updates=300, lr=3.75925e-05, gnorm=1.142, loss_scale=16, train_wall=568, gb_free=3.3, wall=1824
2022-02-18 09:03:48 | INFO | train_inner | epoch 001:    405 / 788 loss=11.11, nll_loss=10.914, ppl=1930.15, wps=11092.2, ups=0.17, wpb=65536, bsz=128, num_updates=400, lr=5.009e-05, gnorm=0.68, loss_scale=32, train_wall=568, gb_free=3.3, wall=2415
2022-02-18 09:13:39 | INFO | train_inner | epoch 001:    505 / 788 loss=10.409, nll_loss=10.177, ppl=1157.39, wps=11077, ups=0.17, wpb=65536, bsz=128, num_updates=500, lr=6.25875e-05, gnorm=0.528, loss_scale=32, train_wall=568, gb_free=3.3, wall=3007
2022-02-18 09:15:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 09:23:37 | INFO | train_inner | epoch 001:    606 / 788 loss=10.044, nll_loss=9.792, ppl=886.38, wps=10970.4, ups=0.17, wpb=65534.7, bsz=128, num_updates=600, lr=7.5085e-05, gnorm=0.573, loss_scale=32, train_wall=574, gb_free=3.3, wall=3604
2022-02-18 09:28:26 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 09:33:34 | INFO | train_inner | epoch 001:    707 / 788 loss=9.772, nll_loss=9.508, ppl=727.92, wps=10970.4, ups=0.17, wpb=65536, bsz=128, num_updates=700, lr=8.75825e-05, gnorm=0.663, loss_scale=32, train_wall=574, gb_free=3.3, wall=4201
2022-02-18 09:41:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 09:41:30 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 09:41:38 | INFO | valid | epoch 001 | valid on 'valid' subset | loss 9.359 | nll_loss 9.08 | ppl 541.27 | wps 26642.9 | wpb 510.9 | bsz 1 | num_updates 780
2022-02-18 09:41:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 780 updates
2022-02-18 09:41:38 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint1.pt
2022-02-18 09:41:44 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint1.pt
2022-02-18 09:41:58 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint1.pt (epoch 1 @ 780 updates, score 9.359) (writing took 19.8160660834983 seconds)
2022-02-18 09:41:58 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2022-02-18 09:41:58 | INFO | train | epoch 001 | loss 12.08 | nll_loss 11.896 | ppl 3811.03 | wps 10973.3 | ups 0.17 | wpb 65497.1 | bsz 127.9 | num_updates 780 | lr 9.75805e-05 | gnorm 1.166 | loss_scale 32 | train_wall 4492 | gb_free 3.3 | wall 4705
2022-02-18 09:41:58 | INFO | fairseq.trainer | begin training epoch 2
2022-02-18 09:41:58 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 09:43:57 | INFO | train_inner | epoch 002:     20 / 788 loss=9.533, nll_loss=9.259, ppl=612.8, wps=10473.3, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=800, lr=0.00010008, gnorm=0.714, loss_scale=32, train_wall=571, gb_free=3.3, wall=4824
2022-02-18 09:53:48 | INFO | train_inner | epoch 002:    120 / 788 loss=9.299, nll_loss=9.017, ppl=518, wps=11091, ups=0.17, wpb=65536, bsz=128, num_updates=900, lr=0.000112578, gnorm=0.822, loss_scale=32, train_wall=568, gb_free=3.3, wall=5415
2022-02-18 09:54:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 10:03:46 | INFO | train_inner | epoch 002:    221 / 788 loss=9.099, nll_loss=8.81, ppl=448.78, wps=10961.7, ups=0.17, wpb=65536, bsz=128, num_updates=1000, lr=0.000125075, gnorm=0.849, loss_scale=32, train_wall=574, gb_free=3.3, wall=6013
2022-02-18 10:07:42 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 10:11:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 10:13:48 | INFO | train_inner | epoch 002:    323 / 788 loss=8.922, nll_loss=8.627, ppl=395.47, wps=10876.7, ups=0.17, wpb=65534.7, bsz=128, num_updates=1100, lr=0.000137573, gnorm=0.918, loss_scale=16, train_wall=579, gb_free=3.3, wall=6616
2022-02-18 10:23:39 | INFO | train_inner | epoch 002:    423 / 788 loss=8.773, nll_loss=8.474, ppl=355.64, wps=11082.5, ups=0.17, wpb=65536, bsz=128, num_updates=1200, lr=0.00015007, gnorm=0.921, loss_scale=16, train_wall=568, gb_free=3.3, wall=7207
2022-02-18 10:29:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 10:33:37 | INFO | train_inner | epoch 002:    524 / 788 loss=8.617, nll_loss=8.314, ppl=318.22, wps=10974.2, ups=0.17, wpb=65536, bsz=128, num_updates=1300, lr=0.000162568, gnorm=0.92, loss_scale=16, train_wall=574, gb_free=3.3, wall=7804
2022-02-18 10:43:28 | INFO | train_inner | epoch 002:    624 / 788 loss=8.488, nll_loss=8.182, ppl=290.33, wps=11080.5, ups=0.17, wpb=65536, bsz=128, num_updates=1400, lr=0.000175065, gnorm=0.938, loss_scale=32, train_wall=568, gb_free=3.3, wall=8396
2022-02-18 10:53:20 | INFO | train_inner | epoch 002:    724 / 788 loss=8.362, nll_loss=8.052, ppl=265.36, wps=11076.6, ups=0.17, wpb=65536, bsz=128, num_updates=1500, lr=0.000187563, gnorm=0.962, loss_scale=32, train_wall=568, gb_free=3.3, wall=8987
2022-02-18 10:54:25 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 10:59:36 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 10:59:44 | INFO | valid | epoch 002 | valid on 'valid' subset | loss 8.074 | nll_loss 7.754 | ppl 215.83 | wps 27253.5 | wpb 510.9 | bsz 1 | num_updates 1563 | best_loss 8.074
2022-02-18 10:59:44 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 1563 updates
2022-02-18 10:59:44 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint2.pt
2022-02-18 10:59:49 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint2.pt
2022-02-18 11:00:03 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint2.pt (epoch 2 @ 1563 updates, score 8.074) (writing took 19.327818469144404 seconds)
2022-02-18 11:00:03 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2022-02-18 11:00:03 | INFO | train | epoch 002 | loss 8.768 | nll_loss 8.47 | ppl 354.47 | wps 10946.1 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 1563 | lr 0.000195436 | gnorm 0.902 | loss_scale 32 | train_wall 4473 | gb_free 3.3 | wall 9390
2022-02-18 11:00:03 | INFO | fairseq.trainer | begin training epoch 3
2022-02-18 11:00:03 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 11:03:42 | INFO | train_inner | epoch 003:     37 / 788 loss=8.217, nll_loss=7.903, ppl=239.31, wps=10476.5, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=1600, lr=0.00020006, gnorm=0.949, loss_scale=32, train_wall=571, gb_free=3.3, wall=9610
2022-02-18 11:07:33 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 11:13:39 | INFO | train_inner | epoch 003:    138 / 788 loss=8.089, nll_loss=7.771, ppl=218.42, wps=10977.5, ups=0.17, wpb=65536, bsz=128, num_updates=1700, lr=0.000212558, gnorm=0.92, loss_scale=32, train_wall=573, gb_free=3.3, wall=10207
2022-02-18 11:20:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 11:23:37 | INFO | train_inner | epoch 003:    239 / 788 loss=7.977, nll_loss=7.655, ppl=201.57, wps=10966, ups=0.17, wpb=65534.7, bsz=128, num_updates=1800, lr=0.000225055, gnorm=0.923, loss_scale=32, train_wall=574, gb_free=3.3, wall=10804
2022-02-18 11:33:28 | INFO | train_inner | epoch 003:    339 / 788 loss=7.883, nll_loss=7.559, ppl=188.56, wps=11089.8, ups=0.17, wpb=65536, bsz=128, num_updates=1900, lr=0.000237553, gnorm=0.901, loss_scale=64, train_wall=568, gb_free=3.3, wall=11395
2022-02-18 11:34:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 11:43:26 | INFO | train_inner | epoch 003:    440 / 788 loss=7.795, nll_loss=7.469, ppl=177.13, wps=10962.5, ups=0.17, wpb=65536, bsz=128, num_updates=2000, lr=0.00025005, gnorm=0.882, loss_scale=32, train_wall=574, gb_free=3.3, wall=11993
2022-02-18 11:47:11 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 11:53:23 | INFO | train_inner | epoch 003:    541 / 788 loss=7.711, nll_loss=7.383, ppl=166.89, wps=10969.8, ups=0.17, wpb=65536, bsz=128, num_updates=2100, lr=0.000262548, gnorm=0.869, loss_scale=32, train_wall=574, gb_free=3.3, wall=12591
2022-02-18 12:00:17 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 12:03:21 | INFO | train_inner | epoch 003:    642 / 788 loss=7.623, nll_loss=7.292, ppl=156.67, wps=10964.8, ups=0.17, wpb=65536, bsz=128, num_updates=2200, lr=0.000275045, gnorm=0.864, loss_scale=32, train_wall=574, gb_free=3.3, wall=13188
2022-02-18 12:13:00 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 12:13:18 | INFO | train_inner | epoch 003:    743 / 788 loss=7.55, nll_loss=7.217, ppl=148.79, wps=10978.2, ups=0.17, wpb=65536, bsz=128, num_updates=2300, lr=0.000287543, gnorm=0.837, loss_scale=32, train_wall=573, gb_free=3.3, wall=13785
2022-02-18 12:17:42 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 12:17:50 | INFO | valid | epoch 003 | valid on 'valid' subset | loss 7.331 | nll_loss 6.986 | ppl 126.8 | wps 27294.4 | wpb 510.9 | bsz 1 | num_updates 2345 | best_loss 7.331
2022-02-18 12:17:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 2345 updates
2022-02-18 12:17:50 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint3.pt
2022-02-18 12:17:56 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint3.pt
2022-02-18 12:18:09 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint3.pt (epoch 3 @ 2345 updates, score 7.331) (writing took 19.338428265415132 seconds)
2022-02-18 12:18:09 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2022-02-18 12:18:09 | INFO | train | epoch 003 | loss 7.802 | nll_loss 7.476 | ppl 178 | wps 10929.6 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 2345 | lr 0.000293166 | gnorm 0.887 | loss_scale 32 | train_wall 4474 | gb_free 3.3 | wall 14077
2022-02-18 12:18:09 | INFO | fairseq.trainer | begin training epoch 4
2022-02-18 12:18:09 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 12:23:35 | INFO | train_inner | epoch 004:     55 / 788 loss=7.428, nll_loss=7.091, ppl=136.35, wps=10565, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=2400, lr=0.00030004, gnorm=0.836, loss_scale=32, train_wall=566, gb_free=3.3, wall=14403
2022-02-18 12:27:20 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 12:33:33 | INFO | train_inner | epoch 004:    156 / 788 loss=7.333, nll_loss=6.994, ppl=127.45, wps=10970.4, ups=0.17, wpb=65536, bsz=128, num_updates=2500, lr=0.000312538, gnorm=0.822, loss_scale=32, train_wall=573, gb_free=3.3, wall=15000
2022-02-18 12:40:44 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 12:43:30 | INFO | train_inner | epoch 004:    257 / 788 loss=7.267, nll_loss=6.925, ppl=121.52, wps=10964.5, ups=0.17, wpb=65534.7, bsz=128, num_updates=2600, lr=0.000325035, gnorm=0.805, loss_scale=32, train_wall=574, gb_free=3.3, wall=15598
2022-02-18 12:49:02 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 12:53:28 | INFO | train_inner | epoch 004:    358 / 788 loss=7.225, nll_loss=6.883, ppl=118.02, wps=10968.8, ups=0.17, wpb=65536, bsz=128, num_updates=2700, lr=0.000337533, gnorm=0.807, loss_scale=16, train_wall=574, gb_free=3.3, wall=16195
2022-02-18 13:03:20 | INFO | train_inner | epoch 004:    458 / 788 loss=7.153, nll_loss=6.809, ppl=112.1, wps=11074, ups=0.17, wpb=65536, bsz=128, num_updates=2800, lr=0.00035003, gnorm=0.773, loss_scale=32, train_wall=568, gb_free=3.3, wall=16787
2022-02-18 13:06:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 13:13:16 | INFO | train_inner | epoch 004:    559 / 788 loss=7.104, nll_loss=6.758, ppl=108.25, wps=10986.5, ups=0.17, wpb=65536, bsz=128, num_updates=2900, lr=0.000362528, gnorm=0.773, loss_scale=16, train_wall=573, gb_free=3.3, wall=17384
2022-02-18 13:23:08 | INFO | train_inner | epoch 004:    659 / 788 loss=7.056, nll_loss=6.709, ppl=104.59, wps=11074.1, ups=0.17, wpb=65536, bsz=128, num_updates=3000, lr=0.000375025, gnorm=0.785, loss_scale=32, train_wall=568, gb_free=3.3, wall=17975
2022-02-18 13:27:16 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 13:33:05 | INFO | train_inner | epoch 004:    760 / 788 loss=6.997, nll_loss=6.648, ppl=100.27, wps=10980.3, ups=0.17, wpb=65536, bsz=128, num_updates=3100, lr=0.000387523, gnorm=0.753, loss_scale=16, train_wall=573, gb_free=3.3, wall=18572
2022-02-18 13:35:47 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 13:35:55 | INFO | valid | epoch 004 | valid on 'valid' subset | loss 6.856 | nll_loss 6.501 | ppl 90.55 | wps 27146.8 | wpb 510.9 | bsz 1 | num_updates 3128 | best_loss 6.856
2022-02-18 13:35:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 3128 updates
2022-02-18 13:35:55 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint4.pt
2022-02-18 13:36:01 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint4.pt
2022-02-18 13:36:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint4.pt (epoch 4 @ 3128 updates, score 6.856) (writing took 21.730967352166772 seconds)
2022-02-18 13:36:17 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2022-02-18 13:36:17 | INFO | train | epoch 004 | loss 7.17 | nll_loss 6.826 | ppl 113.48 | wps 10939.6 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 3128 | lr 0.000391022 | gnorm 0.791 | loss_scale 16 | train_wall 4472 | gb_free 3.3 | wall 18765
2022-02-18 13:36:17 | INFO | fairseq.trainer | begin training epoch 5
2022-02-18 13:36:17 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 13:43:24 | INFO | train_inner | epoch 005:     72 / 788 loss=6.869, nll_loss=6.516, ppl=91.53, wps=10543.4, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=3200, lr=0.00040002, gnorm=0.755, loss_scale=32, train_wall=565, gb_free=3.3, wall=19191
2022-02-18 13:53:15 | INFO | train_inner | epoch 005:    172 / 788 loss=6.818, nll_loss=6.463, ppl=88.24, wps=11082.2, ups=0.17, wpb=65536, bsz=128, num_updates=3300, lr=0.000412518, gnorm=0.724, loss_scale=64, train_wall=568, gb_free=3.3, wall=19782
2022-02-18 13:53:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 14:03:13 | INFO | train_inner | epoch 005:    273 / 788 loss=6.791, nll_loss=6.436, ppl=86.58, wps=10956.4, ups=0.17, wpb=65534.7, bsz=128, num_updates=3400, lr=0.000425015, gnorm=0.75, loss_scale=32, train_wall=574, gb_free=3.3, wall=20381
2022-02-18 14:06:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 14:13:10 | INFO | train_inner | epoch 005:    374 / 788 loss=6.754, nll_loss=6.399, ppl=84.36, wps=10977.4, ups=0.17, wpb=65536, bsz=128, num_updates=3500, lr=0.000437513, gnorm=0.713, loss_scale=32, train_wall=573, gb_free=3.3, wall=20978
2022-02-18 14:14:15 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 14:23:09 | INFO | train_inner | epoch 005:    475 / 788 loss=6.722, nll_loss=6.365, ppl=82.43, wps=10947.7, ups=0.17, wpb=65536, bsz=128, num_updates=3600, lr=0.00045001, gnorm=0.716, loss_scale=16, train_wall=575, gb_free=3.3, wall=21576
2022-02-18 14:32:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 14:33:06 | INFO | train_inner | epoch 005:    576 / 788 loss=6.695, nll_loss=6.337, ppl=80.86, wps=10981, ups=0.17, wpb=65536, bsz=128, num_updates=3700, lr=0.000462508, gnorm=0.712, loss_scale=16, train_wall=573, gb_free=3.3, wall=22173
2022-02-18 14:42:57 | INFO | train_inner | epoch 005:    676 / 788 loss=6.669, nll_loss=6.311, ppl=79.41, wps=11081.7, ups=0.17, wpb=65536, bsz=128, num_updates=3800, lr=0.000475005, gnorm=0.685, loss_scale=16, train_wall=568, gb_free=3.3, wall=22764
2022-02-18 14:46:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 14:52:54 | INFO | train_inner | epoch 005:    777 / 788 loss=6.632, nll_loss=6.273, ppl=77.31, wps=10976.9, ups=0.17, wpb=65536, bsz=128, num_updates=3900, lr=0.000487503, gnorm=0.692, loss_scale=16, train_wall=573, gb_free=3.3, wall=23361
2022-02-18 14:53:56 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 14:54:06 | INFO | valid | epoch 005 | valid on 'valid' subset | loss 6.551 | nll_loss 6.179 | ppl 72.44 | wps 22859.8 | wpb 510.9 | bsz 1 | num_updates 3911 | best_loss 6.551
2022-02-18 14:54:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 3911 updates
2022-02-18 14:54:06 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint5.pt
2022-02-18 14:54:12 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint5.pt
2022-02-18 14:54:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint5.pt (epoch 5 @ 3911 updates, score 6.551) (writing took 20.350835024379194 seconds)
2022-02-18 14:54:26 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2022-02-18 14:54:26 | INFO | train | epoch 005 | loss 6.734 | nll_loss 6.378 | ppl 83.18 | wps 10937.4 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 3911 | lr 0.000488877 | gnorm 0.715 | loss_scale 16 | train_wall 4473 | gb_free 3.3 | wall 23454
2022-02-18 14:54:26 | INFO | fairseq.trainer | begin training epoch 6
2022-02-18 14:54:26 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 14:59:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 15:03:18 | INFO | train_inner | epoch 006:     90 / 788 loss=6.484, nll_loss=6.121, ppl=69.6, wps=10453.9, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=4000, lr=0.0005, gnorm=0.689, loss_scale=16, train_wall=570, gb_free=3.3, wall=23985
2022-02-18 15:13:09 | INFO | train_inner | epoch 006:    190 / 788 loss=6.463, nll_loss=6.098, ppl=68.52, wps=11095.3, ups=0.17, wpb=65534.7, bsz=128, num_updates=4100, lr=0.000493865, gnorm=0.666, loss_scale=32, train_wall=567, gb_free=3.3, wall=24576
2022-02-18 15:18:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 15:23:06 | INFO | train_inner | epoch 006:    291 / 788 loss=6.447, nll_loss=6.083, ppl=67.77, wps=10965.2, ups=0.17, wpb=65536, bsz=128, num_updates=4200, lr=0.00048795, gnorm=0.651, loss_scale=16, train_wall=574, gb_free=3.3, wall=25174
2022-02-18 15:32:57 | INFO | train_inner | epoch 006:    391 / 788 loss=6.431, nll_loss=6.066, ppl=67, wps=11097.7, ups=0.17, wpb=65536, bsz=128, num_updates=4300, lr=0.000482243, gnorm=0.629, loss_scale=32, train_wall=567, gb_free=3.3, wall=25764
2022-02-18 15:42:49 | INFO | train_inner | epoch 006:    491 / 788 loss=6.409, nll_loss=6.044, ppl=65.99, wps=11073, ups=0.17, wpb=65536, bsz=128, num_updates=4400, lr=0.000476731, gnorm=0.622, loss_scale=32, train_wall=568, gb_free=3.3, wall=26356
2022-02-18 15:44:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 15:49:48 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 15:52:51 | INFO | train_inner | epoch 006:    593 / 788 loss=6.389, nll_loss=6.023, ppl=65.04, wps=10879.8, ups=0.17, wpb=65536, bsz=128, num_updates=4500, lr=0.000471405, gnorm=0.618, loss_scale=16, train_wall=579, gb_free=3.3, wall=26959
2022-02-18 16:02:43 | INFO | train_inner | epoch 006:    693 / 788 loss=6.378, nll_loss=6.012, ppl=64.54, wps=11077.1, ups=0.17, wpb=65536, bsz=128, num_updates=4600, lr=0.000466252, gnorm=0.596, loss_scale=32, train_wall=568, gb_free=3.3, wall=27550
2022-02-18 16:12:03 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 16:12:11 | INFO | valid | epoch 006 | valid on 'valid' subset | loss 6.328 | nll_loss 5.955 | ppl 62.03 | wps 27215.8 | wpb 510.9 | bsz 1 | num_updates 4695 | best_loss 6.328
2022-02-18 16:12:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 4695 updates
2022-02-18 16:12:11 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint6.pt
2022-02-18 16:12:17 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint6.pt
2022-02-18 16:12:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint6.pt (epoch 6 @ 4695 updates, score 6.328) (writing took 19.44894079118967 seconds)
2022-02-18 16:12:31 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2022-02-18 16:12:31 | INFO | train | epoch 006 | loss 6.417 | nll_loss 6.052 | ppl 66.34 | wps 10961.5 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 4695 | lr 0.000461511 | gnorm 0.633 | loss_scale 32 | train_wall 4472 | gb_free 3.3 | wall 28138
2022-02-18 16:12:31 | INFO | fairseq.trainer | begin training epoch 7
2022-02-18 16:12:31 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 16:13:00 | INFO | train_inner | epoch 007:      5 / 788 loss=6.344, nll_loss=5.978, ppl=63.03, wps=10562.9, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=4700, lr=0.000461266, gnorm=0.587, loss_scale=32, train_wall=567, gb_free=3.3, wall=28168
2022-02-18 16:15:58 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 16:22:58 | INFO | train_inner | epoch 007:    106 / 788 loss=6.18, nll_loss=5.809, ppl=56.06, wps=10967.1, ups=0.17, wpb=65536, bsz=128, num_updates=4800, lr=0.000456435, gnorm=0.584, loss_scale=32, train_wall=574, gb_free=3.3, wall=28765
2022-02-18 16:29:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 16:29:40 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 16:33:01 | INFO | train_inner | epoch 007:    208 / 788 loss=6.19, nll_loss=5.819, ppl=56.45, wps=10870.9, ups=0.17, wpb=65536, bsz=128, num_updates=4900, lr=0.000451754, gnorm=0.598, loss_scale=16, train_wall=579, gb_free=3.3, wall=29368
2022-02-18 16:42:53 | INFO | train_inner | epoch 007:    308 / 788 loss=6.172, nll_loss=5.801, ppl=55.75, wps=11068, ups=0.17, wpb=65536, bsz=128, num_updates=5000, lr=0.000447214, gnorm=0.581, loss_scale=32, train_wall=568, gb_free=3.3, wall=29960
2022-02-18 16:52:44 | INFO | train_inner | epoch 007:    408 / 788 loss=6.182, nll_loss=5.811, ppl=56.15, wps=11088.3, ups=0.17, wpb=65536, bsz=128, num_updates=5100, lr=0.000442807, gnorm=0.57, loss_scale=32, train_wall=568, gb_free=3.3, wall=30551
2022-02-18 16:55:06 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 16:56:29 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 17:02:47 | INFO | train_inner | epoch 007:    510 / 788 loss=6.178, nll_loss=5.808, ppl=56.01, wps=10864.9, ups=0.17, wpb=65536, bsz=128, num_updates=5200, lr=0.000438529, gnorm=0.572, loss_scale=16, train_wall=579, gb_free=3.3, wall=31155
2022-02-18 17:12:38 | INFO | train_inner | epoch 007:    610 / 788 loss=6.168, nll_loss=5.797, ppl=55.59, wps=11098.5, ups=0.17, wpb=65536, bsz=128, num_updates=5300, lr=0.000434372, gnorm=0.554, loss_scale=32, train_wall=567, gb_free=3.3, wall=31745
2022-02-18 17:14:36 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 17:22:35 | INFO | train_inner | epoch 007:    711 / 788 loss=6.17, nll_loss=5.799, ppl=55.69, wps=10963.9, ups=0.17, wpb=65536, bsz=128, num_updates=5400, lr=0.000430331, gnorm=0.573, loss_scale=16, train_wall=574, gb_free=3.3, wall=32343
2022-02-18 17:29:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 17:30:08 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 17:30:16 | INFO | valid | epoch 007 | valid on 'valid' subset | loss 6.191 | nll_loss 5.819 | ppl 56.44 | wps 27047.3 | wpb 510.9 | bsz 1 | num_updates 5476 | best_loss 6.191
2022-02-18 17:30:16 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 5476 updates
2022-02-18 17:30:16 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint7.pt
2022-02-18 17:30:22 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint7.pt
2022-02-18 17:30:35 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint7.pt (epoch 7 @ 5476 updates, score 6.191) (writing took 19.422548638656735 seconds)
2022-02-18 17:30:35 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2022-02-18 17:30:35 | INFO | train | epoch 007 | loss 6.175 | nll_loss 5.804 | ppl 55.87 | wps 10919.7 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 5476 | lr 0.000427335 | gnorm 0.574 | loss_scale 16 | train_wall 4472 | gb_free 3.3 | wall 32823
2022-02-18 17:30:35 | INFO | fairseq.trainer | begin training epoch 8
2022-02-18 17:30:35 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 17:32:57 | INFO | train_inner | epoch 008:     24 / 788 loss=6.113, nll_loss=5.741, ppl=53.47, wps=10496.7, ups=0.16, wpb=65232.6, bsz=127.4, num_updates=5500, lr=0.000426401, gnorm=0.567, loss_scale=16, train_wall=570, gb_free=3.3, wall=32964
2022-02-18 17:42:48 | INFO | train_inner | epoch 008:    124 / 788 loss=5.984, nll_loss=5.609, ppl=48.79, wps=11082.4, ups=0.17, wpb=65536, bsz=128, num_updates=5600, lr=0.000422577, gnorm=0.551, loss_scale=32, train_wall=568, gb_free=3.3, wall=33556
2022-02-18 17:52:39 | INFO | train_inner | epoch 008:    224 / 788 loss=6, nll_loss=5.624, ppl=49.33, wps=11094.1, ups=0.17, wpb=65536, bsz=128, num_updates=5700, lr=0.000418854, gnorm=0.539, loss_scale=32, train_wall=567, gb_free=3.3, wall=34146
2022-02-18 17:55:37 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 18:02:38 | INFO | train_inner | epoch 008:    325 / 788 loss=6.01, nll_loss=5.635, ppl=49.69, wps=10947.2, ups=0.17, wpb=65536, bsz=128, num_updates=5800, lr=0.000415227, gnorm=0.56, loss_scale=32, train_wall=575, gb_free=3.3, wall=34745
2022-02-18 18:05:53 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 18:12:35 | INFO | train_inner | epoch 008:    426 / 788 loss=6.003, nll_loss=5.627, ppl=49.42, wps=10978.5, ups=0.17, wpb=65536, bsz=128, num_updates=5900, lr=0.000411693, gnorm=0.552, loss_scale=16, train_wall=573, gb_free=3.3, wall=35342
2022-02-18 18:22:26 | INFO | train_inner | epoch 008:    526 / 788 loss=6.013, nll_loss=5.638, ppl=49.79, wps=11070.5, ups=0.17, wpb=65536, bsz=128, num_updates=6000, lr=0.000408248, gnorm=0.542, loss_scale=32, train_wall=568, gb_free=3.3, wall=35934
2022-02-18 18:31:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-02-18 18:32:23 | INFO | train_inner | epoch 008:    627 / 788 loss=6.009, nll_loss=5.634, ppl=49.67, wps=10983.6, ups=0.17, wpb=65534.7, bsz=128, num_updates=6100, lr=0.000404888, gnorm=0.547, loss_scale=32, train_wall=573, gb_free=3.3, wall=36531
2022-02-18 18:32:29 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 18:42:20 | INFO | train_inner | epoch 008:    728 / 788 loss=6.002, nll_loss=5.627, ppl=49.42, wps=10973.7, ups=0.17, wpb=65536, bsz=128, num_updates=6200, lr=0.00040161, gnorm=0.552, loss_scale=16, train_wall=573, gb_free=3.3, wall=37128
2022-02-18 18:47:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 18:48:13 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 18:48:21 | INFO | valid | epoch 008 | valid on 'valid' subset | loss 6.102 | nll_loss 5.719 | ppl 52.66 | wps 27148.8 | wpb 510.9 | bsz 1 | num_updates 6259 | best_loss 6.102
2022-02-18 18:48:21 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 6259 updates
2022-02-18 18:48:21 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint8.pt
2022-02-18 18:48:27 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint8.pt
2022-02-18 18:48:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint8.pt (epoch 8 @ 6259 updates, score 6.102) (writing took 19.481473182328045 seconds)
2022-02-18 18:48:40 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2022-02-18 18:48:40 | INFO | train | epoch 008 | loss 6.004 | nll_loss 5.629 | ppl 49.48 | wps 10946.5 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 6259 | lr 0.000399712 | gnorm 0.549 | loss_scale 16 | train_wall 4471 | gb_free 3.3 | wall 37508
2022-02-18 18:48:40 | INFO | fairseq.trainer | begin training epoch 9
2022-02-18 18:48:40 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 18:52:43 | INFO | train_inner | epoch 009:     41 / 788 loss=5.945, nll_loss=5.569, ppl=47.47, wps=10481.5, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=6300, lr=0.00039841, gnorm=0.532, loss_scale=16, train_wall=571, gb_free=3.3, wall=37750
2022-02-18 19:02:34 | INFO | train_inner | epoch 009:    141 / 788 loss=5.852, nll_loss=5.473, ppl=44.41, wps=11090.1, ups=0.17, wpb=65536, bsz=128, num_updates=6400, lr=0.000395285, gnorm=0.545, loss_scale=32, train_wall=567, gb_free=3.3, wall=38341
2022-02-18 19:05:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 19:12:30 | INFO | train_inner | epoch 009:    242 / 788 loss=5.855, nll_loss=5.476, ppl=44.5, wps=10988.9, ups=0.17, wpb=65536, bsz=128, num_updates=6500, lr=0.000392232, gnorm=0.538, loss_scale=16, train_wall=573, gb_free=3.3, wall=38937
2022-02-18 19:21:58 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 19:22:27 | INFO | train_inner | epoch 009:    343 / 788 loss=5.869, nll_loss=5.49, ppl=44.93, wps=10975.9, ups=0.17, wpb=65536, bsz=128, num_updates=6600, lr=0.000389249, gnorm=0.544, loss_scale=16, train_wall=573, gb_free=3.3, wall=39535
2022-02-18 19:32:18 | INFO | train_inner | epoch 009:    443 / 788 loss=5.885, nll_loss=5.506, ppl=45.45, wps=11091.8, ups=0.17, wpb=65534.7, bsz=128, num_updates=6700, lr=0.000386334, gnorm=0.53, loss_scale=16, train_wall=567, gb_free=3.3, wall=40125
2022-02-18 19:42:10 | INFO | train_inner | epoch 009:    543 / 788 loss=5.887, nll_loss=5.508, ppl=45.51, wps=11078.5, ups=0.17, wpb=65536, bsz=128, num_updates=6800, lr=0.000383482, gnorm=0.535, loss_scale=32, train_wall=568, gb_free=3.3, wall=40717
2022-02-18 19:42:15 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 19:52:06 | INFO | train_inner | epoch 009:    644 / 788 loss=5.895, nll_loss=5.517, ppl=45.79, wps=10989.6, ups=0.17, wpb=65536, bsz=128, num_updates=6900, lr=0.000380693, gnorm=0.538, loss_scale=16, train_wall=573, gb_free=3.3, wall=41313
2022-02-18 20:01:35 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 20:02:05 | INFO | train_inner | epoch 009:    745 / 788 loss=5.89, nll_loss=5.512, ppl=45.63, wps=10942.9, ups=0.17, wpb=65536, bsz=128, num_updates=7000, lr=0.000377964, gnorm=0.533, loss_scale=16, train_wall=575, gb_free=3.3, wall=41912
2022-02-18 20:06:16 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 20:06:24 | INFO | valid | epoch 009 | valid on 'valid' subset | loss 6.024 | nll_loss 5.647 | ppl 50.1 | wps 27306 | wpb 510.9 | bsz 1 | num_updates 7043 | best_loss 6.024
2022-02-18 20:06:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 7043 updates
2022-02-18 20:06:24 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint9.pt
2022-02-18 20:06:30 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint9.pt
2022-02-18 20:06:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint9.pt (epoch 9 @ 7043 updates, score 6.024) (writing took 19.43323744740337 seconds)
2022-02-18 20:06:43 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2022-02-18 20:06:43 | INFO | train | epoch 009 | loss 5.875 | nll_loss 5.496 | ppl 45.14 | wps 10965.1 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 7043 | lr 0.000376809 | gnorm 0.537 | loss_scale 16 | train_wall 4471 | gb_free 3.3 | wall 42191
2022-02-18 20:06:43 | INFO | fairseq.trainer | begin training epoch 10
2022-02-18 20:06:43 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 20:12:20 | INFO | train_inner | epoch 010:     57 / 788 loss=5.801, nll_loss=5.42, ppl=42.82, wps=10597, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=7100, lr=0.000375293, gnorm=0.548, loss_scale=16, train_wall=564, gb_free=3.3, wall=42528
2022-02-18 20:14:55 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 20:22:18 | INFO | train_inner | epoch 010:    158 / 788 loss=5.739, nll_loss=5.356, ppl=40.96, wps=10965.2, ups=0.17, wpb=65536, bsz=128, num_updates=7200, lr=0.000372678, gnorm=0.542, loss_scale=16, train_wall=574, gb_free=3.3, wall=43125
2022-02-18 20:32:10 | INFO | train_inner | epoch 010:    258 / 788 loss=5.753, nll_loss=5.37, ppl=41.36, wps=11071.9, ups=0.17, wpb=65536, bsz=128, num_updates=7300, lr=0.000370117, gnorm=0.538, loss_scale=32, train_wall=568, gb_free=3.3, wall=43717
2022-02-18 20:32:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 20:42:07 | INFO | train_inner | epoch 010:    359 / 788 loss=5.769, nll_loss=5.387, ppl=41.84, wps=10977, ups=0.17, wpb=65536, bsz=128, num_updates=7400, lr=0.000367607, gnorm=0.533, loss_scale=16, train_wall=573, gb_free=3.3, wall=44314
2022-02-18 20:46:15 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 20:52:04 | INFO | train_inner | epoch 010:    460 / 788 loss=5.777, nll_loss=5.395, ppl=42.09, wps=10985.8, ups=0.17, wpb=65536, bsz=128, num_updates=7500, lr=0.000365148, gnorm=0.516, loss_scale=16, train_wall=573, gb_free=3.3, wall=44911
2022-02-18 21:00:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 21:02:01 | INFO | train_inner | epoch 010:    561 / 788 loss=5.789, nll_loss=5.408, ppl=42.47, wps=10969.2, ups=0.17, wpb=65534.7, bsz=128, num_updates=7600, lr=0.000362738, gnorm=0.538, loss_scale=16, train_wall=574, gb_free=3.3, wall=45508
2022-02-18 21:11:52 | INFO | train_inner | epoch 010:    661 / 788 loss=5.797, nll_loss=5.416, ppl=42.69, wps=11091.5, ups=0.17, wpb=65536, bsz=128, num_updates=7700, lr=0.000360375, gnorm=0.525, loss_scale=16, train_wall=567, gb_free=3.3, wall=46099
2022-02-18 21:14:03 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 21:21:50 | INFO | train_inner | epoch 010:    762 / 788 loss=5.801, nll_loss=5.421, ppl=42.84, wps=10963.6, ups=0.17, wpb=65536, bsz=128, num_updates=7800, lr=0.000358057, gnorm=0.537, loss_scale=16, train_wall=574, gb_free=3.3, wall=46697
2022-02-18 21:24:20 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 21:24:28 | INFO | valid | epoch 010 | valid on 'valid' subset | loss 5.996 | nll_loss 5.603 | ppl 48.62 | wps 27251.2 | wpb 510.9 | bsz 1 | num_updates 7826 | best_loss 5.996
2022-02-18 21:24:28 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 7826 updates
2022-02-18 21:24:28 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint10.pt
2022-02-18 21:24:34 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint10.pt
2022-02-18 21:24:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint10.pt (epoch 10 @ 7826 updates, score 5.996) (writing took 19.441125703044236 seconds)
2022-02-18 21:24:48 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2022-02-18 21:24:48 | INFO | train | epoch 010 | loss 5.772 | nll_loss 5.391 | ppl 41.95 | wps 10947.5 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 7826 | lr 0.000357462 | gnorm 0.534 | loss_scale 16 | train_wall 4471 | gb_free 3.3 | wall 46875
2022-02-18 21:24:48 | INFO | fairseq.trainer | begin training epoch 11
2022-02-18 21:24:48 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 21:28:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 21:32:12 | INFO | train_inner | epoch 011:     75 / 788 loss=5.681, nll_loss=5.297, ppl=39.3, wps=10485.8, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=7900, lr=0.000355784, gnorm=0.54, loss_scale=16, train_wall=571, gb_free=3.3, wall=47319
2022-02-18 21:42:03 | INFO | train_inner | epoch 011:    175 / 788 loss=5.648, nll_loss=5.263, ppl=38.41, wps=11075.1, ups=0.17, wpb=65536, bsz=128, num_updates=8000, lr=0.000353553, gnorm=0.534, loss_scale=32, train_wall=568, gb_free=3.3, wall=47911
2022-02-18 21:43:14 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 21:52:01 | INFO | train_inner | epoch 011:    276 / 788 loss=5.67, nll_loss=5.286, ppl=39.01, wps=10965.1, ups=0.17, wpb=65536, bsz=128, num_updates=8100, lr=0.000351364, gnorm=0.553, loss_scale=16, train_wall=574, gb_free=3.3, wall=48509
2022-02-18 21:56:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 22:01:59 | INFO | train_inner | epoch 011:    377 / 788 loss=5.689, nll_loss=5.305, ppl=39.53, wps=10969, ups=0.17, wpb=65536, bsz=128, num_updates=8200, lr=0.000349215, gnorm=0.523, loss_scale=16, train_wall=573, gb_free=3.3, wall=49106
2022-02-18 22:09:45 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 22:11:55 | INFO | train_inner | epoch 011:    478 / 788 loss=5.696, nll_loss=5.312, ppl=39.74, wps=10992.2, ups=0.17, wpb=65536, bsz=128, num_updates=8300, lr=0.000347105, gnorm=0.523, loss_scale=16, train_wall=573, gb_free=3.3, wall=49702
2022-02-18 22:21:46 | INFO | train_inner | epoch 011:    578 / 788 loss=5.707, nll_loss=5.324, ppl=40.06, wps=11079.4, ups=0.17, wpb=65536, bsz=128, num_updates=8400, lr=0.000345033, gnorm=0.533, loss_scale=16, train_wall=568, gb_free=3.3, wall=50294
2022-02-18 22:22:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 22:31:43 | INFO | train_inner | epoch 011:    679 / 788 loss=5.718, nll_loss=5.335, ppl=40.36, wps=10987.5, ups=0.17, wpb=65536, bsz=128, num_updates=8500, lr=0.000342997, gnorm=0.56, loss_scale=16, train_wall=573, gb_free=3.3, wall=50890
2022-02-18 22:36:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 22:41:40 | INFO | train_inner | epoch 011:    780 / 788 loss=5.727, nll_loss=5.344, ppl=40.62, wps=10967.7, ups=0.17, wpb=65536, bsz=128, num_updates=8600, lr=0.000340997, gnorm=0.522, loss_scale=16, train_wall=574, gb_free=3.3, wall=51488
2022-02-18 22:42:25 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-18 22:42:33 | INFO | valid | epoch 011 | valid on 'valid' subset | loss 5.941 | nll_loss 5.559 | ppl 47.15 | wps 27143.7 | wpb 510.9 | bsz 1 | num_updates 8608 | best_loss 5.941
2022-02-18 22:42:33 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 8608 updates
2022-02-18 22:42:33 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint11.pt
2022-02-18 22:42:39 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint11.pt
2022-02-18 22:42:52 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint11.pt (epoch 11 @ 8608 updates, score 5.941) (writing took 19.516997608356178 seconds)
2022-02-18 22:42:52 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2022-02-18 22:42:52 | INFO | train | epoch 011 | loss 5.688 | nll_loss 5.304 | ppl 39.52 | wps 10933.4 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 8608 | lr 0.000340839 | gnorm 0.537 | loss_scale 16 | train_wall 4471 | gb_free 3.3 | wall 51560
2022-02-18 22:42:53 | INFO | fairseq.trainer | begin training epoch 12
2022-02-18 22:42:53 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-18 22:49:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 22:52:03 | INFO | train_inner | epoch 012:     93 / 788 loss=5.568, nll_loss=5.181, ppl=36.28, wps=10484.3, ups=0.16, wpb=65232.6, bsz=127.4, num_updates=8700, lr=0.000339032, gnorm=0.518, loss_scale=16, train_wall=571, gb_free=3.3, wall=52110
2022-02-18 23:01:54 | INFO | train_inner | epoch 012:    193 / 788 loss=5.587, nll_loss=5.2, ppl=36.76, wps=11079, ups=0.17, wpb=65536, bsz=128, num_updates=8800, lr=0.0003371, gnorm=0.544, loss_scale=16, train_wall=568, gb_free=3.3, wall=52701
2022-02-18 23:03:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 23:11:51 | INFO | train_inner | epoch 012:    294 / 788 loss=5.606, nll_loss=5.22, ppl=37.27, wps=10978.3, ups=0.17, wpb=65536, bsz=128, num_updates=8900, lr=0.000335201, gnorm=0.538, loss_scale=16, train_wall=573, gb_free=3.3, wall=53298
2022-02-18 23:17:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 23:21:48 | INFO | train_inner | epoch 012:    395 / 788 loss=5.621, nll_loss=5.235, ppl=37.66, wps=10977.6, ups=0.17, wpb=65536, bsz=128, num_updates=9000, lr=0.000333333, gnorm=0.531, loss_scale=16, train_wall=573, gb_free=3.3, wall=53895
2022-02-18 23:31:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 23:31:44 | INFO | train_inner | epoch 012:    496 / 788 loss=5.621, nll_loss=5.235, ppl=37.66, wps=10987.2, ups=0.17, wpb=65534.7, bsz=128, num_updates=9100, lr=0.000331497, gnorm=0.54, loss_scale=16, train_wall=573, gb_free=3.3, wall=54492
2022-02-18 23:41:36 | INFO | train_inner | epoch 012:    596 / 788 loss=5.632, nll_loss=5.247, ppl=37.97, wps=11071.9, ups=0.17, wpb=65536, bsz=128, num_updates=9200, lr=0.00032969, gnorm=0.536, loss_scale=16, train_wall=568, gb_free=3.3, wall=55084
2022-02-18 23:45:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-18 23:51:34 | INFO | train_inner | epoch 012:    697 / 788 loss=5.652, nll_loss=5.267, ppl=38.5, wps=10973.6, ups=0.17, wpb=65536, bsz=128, num_updates=9300, lr=0.000327913, gnorm=0.537, loss_scale=16, train_wall=574, gb_free=3.3, wall=55681
2022-02-18 23:58:03 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 00:00:29 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 00:00:37 | INFO | valid | epoch 012 | valid on 'valid' subset | loss 5.922 | nll_loss 5.535 | ppl 46.38 | wps 27105.1 | wpb 510.9 | bsz 1 | num_updates 9390 | best_loss 5.922
2022-02-19 00:00:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 9390 updates
2022-02-19 00:00:37 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint12.pt
2022-02-19 00:00:43 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint12.pt
2022-02-19 00:00:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint12.pt (epoch 12 @ 9390 updates, score 5.922) (writing took 19.492874049581587 seconds)
2022-02-19 00:00:57 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2022-02-19 00:00:57 | INFO | train | epoch 012 | loss 5.617 | nll_loss 5.231 | ppl 37.57 | wps 10934.7 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 9390 | lr 0.000326338 | gnorm 0.536 | loss_scale 16 | train_wall 4471 | gb_free 3.3 | wall 56244
2022-02-19 00:00:57 | INFO | fairseq.trainer | begin training epoch 13
2022-02-19 00:00:57 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 00:01:56 | INFO | train_inner | epoch 013:     10 / 788 loss=5.644, nll_loss=5.259, ppl=38.28, wps=10489.1, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=9400, lr=0.000326164, gnorm=0.546, loss_scale=16, train_wall=571, gb_free=3.3, wall=56303
2022-02-19 00:11:11 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 00:11:53 | INFO | train_inner | epoch 013:    111 / 788 loss=5.494, nll_loss=5.104, ppl=34.4, wps=10976.3, ups=0.17, wpb=65536, bsz=128, num_updates=9500, lr=0.000324443, gnorm=0.538, loss_scale=16, train_wall=573, gb_free=3.3, wall=56900
2022-02-19 00:21:43 | INFO | train_inner | epoch 013:    211 / 788 loss=5.524, nll_loss=5.135, ppl=35.13, wps=11099.7, ups=0.17, wpb=65536, bsz=128, num_updates=9600, lr=0.000322749, gnorm=0.541, loss_scale=16, train_wall=567, gb_free=3.3, wall=57490
2022-02-19 00:25:16 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 00:31:40 | INFO | train_inner | epoch 013:    312 / 788 loss=5.547, nll_loss=5.159, ppl=35.73, wps=10983.6, ups=0.17, wpb=65536, bsz=128, num_updates=9700, lr=0.000321081, gnorm=0.538, loss_scale=16, train_wall=573, gb_free=3.3, wall=58087
2022-02-19 00:38:04 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 00:41:37 | INFO | train_inner | epoch 013:    413 / 788 loss=5.553, nll_loss=5.165, ppl=35.89, wps=10971.9, ups=0.17, wpb=65536, bsz=128, num_updates=9800, lr=0.000319438, gnorm=0.541, loss_scale=16, train_wall=573, gb_free=3.3, wall=58684
2022-02-19 00:50:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 00:51:33 | INFO | train_inner | epoch 013:    514 / 788 loss=5.572, nll_loss=5.185, ppl=36.38, wps=10988.6, ups=0.17, wpb=65534.7, bsz=128, num_updates=9900, lr=0.000317821, gnorm=0.534, loss_scale=16, train_wall=573, gb_free=3.3, wall=59281
2022-02-19 01:01:25 | INFO | train_inner | epoch 013:    614 / 788 loss=5.588, nll_loss=5.202, ppl=36.8, wps=11077.1, ups=0.17, wpb=65536, bsz=128, num_updates=10000, lr=0.000316228, gnorm=0.531, loss_scale=16, train_wall=568, gb_free=3.3, wall=59872
2022-02-19 01:05:03 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 01:11:21 | INFO | train_inner | epoch 013:    715 / 788 loss=5.594, nll_loss=5.208, ppl=36.95, wps=10989.6, ups=0.17, wpb=65536, bsz=128, num_updates=10100, lr=0.000314658, gnorm=0.541, loss_scale=16, train_wall=573, gb_free=3.3, wall=60469
2022-02-19 01:13:50 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 01:18:30 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 01:18:39 | INFO | valid | epoch 013 | valid on 'valid' subset | loss 5.902 | nll_loss 5.513 | ppl 45.66 | wps 26119.4 | wpb 510.9 | bsz 1 | num_updates 10172 | best_loss 5.902
2022-02-19 01:18:39 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 10172 updates
2022-02-19 01:18:39 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint13.pt
2022-02-19 01:18:46 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint13.pt
2022-02-19 01:19:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint13.pt (epoch 13 @ 10172 updates, score 5.902) (writing took 21.923383311368525 seconds)
2022-02-19 01:19:01 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2022-02-19 01:19:01 | INFO | train | epoch 013 | loss 5.557 | nll_loss 5.17 | ppl 35.99 | wps 10934.7 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 10172 | lr 0.000313543 | gnorm 0.54 | loss_scale 8 | train_wall 4469 | gb_free 3.3 | wall 60928
2022-02-19 01:19:01 | INFO | fairseq.trainer | begin training epoch 14
2022-02-19 01:19:01 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 01:21:46 | INFO | train_inner | epoch 014:     28 / 788 loss=5.554, nll_loss=5.167, ppl=35.92, wps=10450.1, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=10200, lr=0.000313112, gnorm=0.547, loss_scale=8, train_wall=570, gb_free=3.3, wall=61093
2022-02-19 01:31:37 | INFO | train_inner | epoch 014:    128 / 788 loss=5.44, nll_loss=5.049, ppl=33.1, wps=11076.6, ups=0.17, wpb=65536, bsz=128, num_updates=10300, lr=0.000311588, gnorm=0.541, loss_scale=16, train_wall=568, gb_free=3.3, wall=61685
2022-02-19 01:41:29 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 01:41:34 | INFO | train_inner | epoch 014:    229 / 788 loss=5.475, nll_loss=5.085, ppl=33.94, wps=10974.5, ups=0.17, wpb=65536, bsz=128, num_updates=10400, lr=0.000310087, gnorm=0.535, loss_scale=16, train_wall=573, gb_free=3.3, wall=62282
2022-02-19 01:51:25 | INFO | train_inner | epoch 014:    329 / 788 loss=5.494, nll_loss=5.104, ppl=34.39, wps=11091.7, ups=0.17, wpb=65536, bsz=128, num_updates=10500, lr=0.000308607, gnorm=0.542, loss_scale=16, train_wall=567, gb_free=3.3, wall=62873
2022-02-19 01:54:11 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 02:01:22 | INFO | train_inner | epoch 014:    430 / 788 loss=5.508, nll_loss=5.118, ppl=34.74, wps=10982.6, ups=0.17, wpb=65534.7, bsz=128, num_updates=10600, lr=0.000307148, gnorm=0.534, loss_scale=16, train_wall=573, gb_free=3.3, wall=63469
2022-02-19 02:07:11 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 02:11:19 | INFO | train_inner | epoch 014:    531 / 788 loss=5.533, nll_loss=5.144, ppl=35.37, wps=10984, ups=0.17, wpb=65536, bsz=128, num_updates=10700, lr=0.000305709, gnorm=0.539, loss_scale=16, train_wall=573, gb_free=3.3, wall=64066
2022-02-19 02:20:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 02:21:16 | INFO | train_inner | epoch 014:    632 / 788 loss=5.535, nll_loss=5.147, ppl=35.43, wps=10975.3, ups=0.17, wpb=65536, bsz=128, num_updates=10800, lr=0.00030429, gnorm=0.558, loss_scale=16, train_wall=573, gb_free=3.3, wall=64663
2022-02-19 02:31:07 | INFO | train_inner | epoch 014:    732 / 788 loss=5.544, nll_loss=5.156, ppl=35.66, wps=11081.6, ups=0.17, wpb=65536, bsz=128, num_updates=10900, lr=0.000302891, gnorm=0.529, loss_scale=16, train_wall=568, gb_free=3.3, wall=65255
2022-02-19 02:32:48 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 02:36:35 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 02:36:45 | INFO | valid | epoch 014 | valid on 'valid' subset | loss 5.878 | nll_loss 5.494 | ppl 45.07 | wps 23151.1 | wpb 510.9 | bsz 1 | num_updates 10955 | best_loss 5.878
2022-02-19 02:36:45 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 10955 updates
2022-02-19 02:36:45 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint14.pt
2022-02-19 02:36:50 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint14.pt
2022-02-19 02:37:04 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint14.pt (epoch 14 @ 10955 updates, score 5.878) (writing took 19.595043145120144 seconds)
2022-02-19 02:37:04 | INFO | fairseq_cli.train | end of epoch 14 (average epoch stats below)
2022-02-19 02:37:04 | INFO | train | epoch 014 | loss 5.505 | nll_loss 5.116 | ppl 34.67 | wps 10949.6 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 10955 | lr 0.00030213 | gnorm 0.54 | loss_scale 16 | train_wall 4469 | gb_free 3.3 | wall 65612
2022-02-19 02:37:04 | INFO | fairseq.trainer | begin training epoch 15
2022-02-19 02:37:04 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 02:41:30 | INFO | train_inner | epoch 015:     45 / 788 loss=5.48, nll_loss=5.09, ppl=34.07, wps=10476.6, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=11000, lr=0.000301511, gnorm=0.534, loss_scale=16, train_wall=570, gb_free=3.3, wall=65877
2022-02-19 02:41:48 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 02:51:27 | INFO | train_inner | epoch 015:    146 / 788 loss=5.407, nll_loss=5.015, ppl=32.34, wps=10965.8, ups=0.17, wpb=65534.7, bsz=128, num_updates=11100, lr=0.00030015, gnorm=0.539, loss_scale=8, train_wall=574, gb_free=3.3, wall=66475
2022-02-19 03:01:18 | INFO | train_inner | epoch 015:    246 / 788 loss=5.43, nll_loss=5.038, ppl=32.87, wps=11096.5, ups=0.17, wpb=65536, bsz=128, num_updates=11200, lr=0.000298807, gnorm=0.53, loss_scale=16, train_wall=567, gb_free=3.3, wall=67066
2022-02-19 03:09:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 03:11:15 | INFO | train_inner | epoch 015:    347 / 788 loss=5.461, nll_loss=5.071, ppl=33.61, wps=10973.1, ups=0.17, wpb=65536, bsz=128, num_updates=11300, lr=0.000297482, gnorm=0.556, loss_scale=16, train_wall=574, gb_free=3.3, wall=67663
2022-02-19 03:21:07 | INFO | train_inner | epoch 015:    447 / 788 loss=5.454, nll_loss=5.063, ppl=33.43, wps=11085.9, ups=0.17, wpb=65536, bsz=128, num_updates=11400, lr=0.000296174, gnorm=0.547, loss_scale=16, train_wall=568, gb_free=3.3, wall=68254
2022-02-19 03:22:17 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 03:29:41 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 03:31:10 | INFO | train_inner | epoch 015:    549 / 788 loss=5.479, nll_loss=5.089, ppl=34.04, wps=10863.6, ups=0.17, wpb=65536, bsz=128, num_updates=11500, lr=0.000294884, gnorm=0.557, loss_scale=8, train_wall=579, gb_free=3.3, wall=68857
2022-02-19 03:41:01 | INFO | train_inner | epoch 015:    649 / 788 loss=5.49, nll_loss=5.101, ppl=34.31, wps=11089.6, ups=0.17, wpb=65536, bsz=128, num_updates=11600, lr=0.00029361, gnorm=0.529, loss_scale=8, train_wall=568, gb_free=3.3, wall=69448
2022-02-19 03:48:36 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 03:50:57 | INFO | train_inner | epoch 015:    750 / 788 loss=5.496, nll_loss=5.106, ppl=34.44, wps=10985.5, ups=0.17, wpb=65536, bsz=128, num_updates=11700, lr=0.000292353, gnorm=0.561, loss_scale=8, train_wall=573, gb_free=3.3, wall=70045
2022-02-19 03:54:39 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 03:54:47 | INFO | valid | epoch 015 | valid on 'valid' subset | loss 5.871 | nll_loss 5.483 | ppl 44.73 | wps 27249 | wpb 510.9 | bsz 1 | num_updates 11738 | best_loss 5.871
2022-02-19 03:54:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 11738 updates
2022-02-19 03:54:47 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint15.pt
2022-02-19 03:54:53 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint15.pt
2022-02-19 03:55:08 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint15.pt (epoch 15 @ 11738 updates, score 5.871) (writing took 20.412212911061943 seconds)
2022-02-19 03:55:08 | INFO | fairseq_cli.train | end of epoch 15 (average epoch stats below)
2022-02-19 03:55:08 | INFO | train | epoch 015 | loss 5.458 | nll_loss 5.067 | ppl 33.52 | wps 10949.9 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 11738 | lr 0.000291879 | gnorm 0.543 | loss_scale 8 | train_wall 4470 | gb_free 3.3 | wall 70295
2022-02-19 03:55:08 | INFO | fairseq.trainer | begin training epoch 16
2022-02-19 03:55:08 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 04:01:14 | INFO | train_inner | epoch 016:     62 / 788 loss=5.402, nll_loss=5.01, ppl=32.22, wps=10572.9, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=11800, lr=0.000291111, gnorm=0.524, loss_scale=8, train_wall=565, gb_free=3.3, wall=70662
2022-02-19 04:11:06 | INFO | train_inner | epoch 016:    162 / 788 loss=5.374, nll_loss=4.981, ppl=31.58, wps=11081.3, ups=0.17, wpb=65536, bsz=128, num_updates=11900, lr=0.000289886, gnorm=0.547, loss_scale=16, train_wall=568, gb_free=3.3, wall=71253
2022-02-19 04:14:20 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 04:21:03 | INFO | train_inner | epoch 016:    263 / 788 loss=5.396, nll_loss=5.004, ppl=32.08, wps=10980.9, ups=0.17, wpb=65536, bsz=128, num_updates=12000, lr=0.000288675, gnorm=0.546, loss_scale=16, train_wall=573, gb_free=3.3, wall=71850
2022-02-19 04:28:44 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 04:30:59 | INFO | train_inner | epoch 016:    364 / 788 loss=5.407, nll_loss=5.015, ppl=32.33, wps=10979.8, ups=0.17, wpb=65534.7, bsz=128, num_updates=12100, lr=0.00028748, gnorm=0.544, loss_scale=16, train_wall=573, gb_free=3.3, wall=72447
2022-02-19 04:40:51 | INFO | train_inner | epoch 016:    464 / 788 loss=5.419, nll_loss=5.027, ppl=32.6, wps=11075.4, ups=0.17, wpb=65536, bsz=128, num_updates=12200, lr=0.000286299, gnorm=0.554, loss_scale=16, train_wall=568, gb_free=3.3, wall=73039
2022-02-19 04:41:38 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 04:42:55 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 04:50:54 | INFO | train_inner | epoch 016:    566 / 788 loss=5.437, nll_loss=5.045, ppl=33.02, wps=10867.7, ups=0.17, wpb=65536, bsz=128, num_updates=12300, lr=0.000285133, gnorm=0.542, loss_scale=8, train_wall=579, gb_free=3.3, wall=73642
2022-02-19 05:00:45 | INFO | train_inner | epoch 016:    666 / 788 loss=5.448, nll_loss=5.057, ppl=33.28, wps=11093.1, ups=0.17, wpb=65536, bsz=128, num_updates=12400, lr=0.000283981, gnorm=0.552, loss_scale=16, train_wall=567, gb_free=3.3, wall=74232
2022-02-19 05:08:50 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 05:10:43 | INFO | train_inner | epoch 016:    767 / 788 loss=5.472, nll_loss=5.081, ppl=33.86, wps=10963.7, ups=0.17, wpb=65536, bsz=128, num_updates=12500, lr=0.000282843, gnorm=0.522, loss_scale=16, train_wall=574, gb_free=3.3, wall=74830
2022-02-19 05:12:44 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 05:12:52 | INFO | valid | epoch 016 | valid on 'valid' subset | loss 5.867 | nll_loss 5.48 | ppl 44.64 | wps 27218.2 | wpb 510.9 | bsz 1 | num_updates 12521 | best_loss 5.867
2022-02-19 05:12:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 12521 updates
2022-02-19 05:12:52 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint16.pt
2022-02-19 05:12:58 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint16.pt
2022-02-19 05:13:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint16.pt (epoch 16 @ 12521 updates, score 5.867) (writing took 19.52132013440132 seconds)
2022-02-19 05:13:11 | INFO | fairseq_cli.train | end of epoch 16 (average epoch stats below)
2022-02-19 05:13:11 | INFO | train | epoch 016 | loss 5.416 | nll_loss 5.024 | ppl 32.54 | wps 10949.7 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 12521 | lr 0.000282605 | gnorm 0.543 | loss_scale 16 | train_wall 4470 | gb_free 3.3 | wall 74979
2022-02-19 05:13:12 | INFO | fairseq.trainer | begin training epoch 17
2022-02-19 05:13:12 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 05:20:59 | INFO | train_inner | epoch 017:     79 / 788 loss=5.34, nll_loss=4.946, ppl=30.82, wps=10583.7, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=12600, lr=0.000281718, gnorm=0.546, loss_scale=16, train_wall=565, gb_free=3.3, wall=75446
2022-02-19 05:22:04 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 05:30:57 | INFO | train_inner | epoch 017:    180 / 788 loss=5.33, nll_loss=4.936, ppl=30.61, wps=10968, ups=0.17, wpb=65536, bsz=128, num_updates=12700, lr=0.000280607, gnorm=0.543, loss_scale=16, train_wall=574, gb_free=3.3, wall=76044
2022-02-19 05:34:58 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 05:40:53 | INFO | train_inner | epoch 017:    281 / 788 loss=5.354, nll_loss=4.96, ppl=31.13, wps=10992.4, ups=0.17, wpb=65536, bsz=128, num_updates=12800, lr=0.000279508, gnorm=0.556, loss_scale=16, train_wall=573, gb_free=3.3, wall=76640
2022-02-19 05:47:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 05:50:50 | INFO | train_inner | epoch 017:    382 / 788 loss=5.366, nll_loss=4.972, ppl=31.39, wps=10967.8, ups=0.17, wpb=65536, bsz=128, num_updates=12900, lr=0.000278423, gnorm=0.535, loss_scale=16, train_wall=574, gb_free=3.3, wall=77238
2022-02-19 06:00:41 | INFO | train_inner | epoch 017:    482 / 788 loss=5.396, nll_loss=5.004, ppl=32.08, wps=11091.8, ups=0.17, wpb=65534.7, bsz=128, num_updates=13000, lr=0.00027735, gnorm=0.537, loss_scale=32, train_wall=567, gb_free=3.3, wall=77829
2022-02-19 06:00:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 06:10:37 | INFO | train_inner | epoch 017:    583 / 788 loss=5.399, nll_loss=5.006, ppl=32.14, wps=10990.2, ups=0.17, wpb=65536, bsz=128, num_updates=13100, lr=0.000276289, gnorm=0.555, loss_scale=16, train_wall=573, gb_free=3.3, wall=78425
2022-02-19 06:13:35 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 06:20:17 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 06:20:41 | INFO | train_inner | epoch 017:    685 / 788 loss=5.424, nll_loss=5.032, ppl=32.71, wps=10866.9, ups=0.17, wpb=65536, bsz=128, num_updates=13200, lr=0.000275241, gnorm=0.535, loss_scale=8, train_wall=579, gb_free=3.3, wall=79028
2022-02-19 06:30:32 | INFO | train_inner | epoch 017:    785 / 788 loss=5.436, nll_loss=5.045, ppl=33.01, wps=11080.5, ups=0.17, wpb=65536, bsz=128, num_updates=13300, lr=0.000274204, gnorm=0.543, loss_scale=8, train_wall=568, gb_free=3.3, wall=79619
2022-02-19 06:30:47 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 06:30:55 | INFO | valid | epoch 017 | valid on 'valid' subset | loss 5.851 | nll_loss 5.463 | ppl 44.1 | wps 27224.8 | wpb 510.9 | bsz 1 | num_updates 13303 | best_loss 5.851
2022-02-19 06:30:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 13303 updates
2022-02-19 06:30:55 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint17.pt
2022-02-19 06:31:01 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint17.pt
2022-02-19 06:31:15 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint17.pt (epoch 17 @ 13303 updates, score 5.851) (writing took 19.59912395849824 seconds)
2022-02-19 06:31:15 | INFO | fairseq_cli.train | end of epoch 17 (average epoch stats below)
2022-02-19 06:31:15 | INFO | train | epoch 017 | loss 5.379 | nll_loss 4.985 | ppl 31.68 | wps 10936.7 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 13303 | lr 0.000274173 | gnorm 0.544 | loss_scale 8 | train_wall 4470 | gb_free 3.3 | wall 79662
2022-02-19 06:31:15 | INFO | fairseq.trainer | begin training epoch 18
2022-02-19 06:31:15 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 06:40:48 | INFO | train_inner | epoch 018:     97 / 788 loss=5.289, nll_loss=4.893, ppl=29.71, wps=10587.2, ups=0.16, wpb=65232.6, bsz=127.4, num_updates=13400, lr=0.000273179, gnorm=0.557, loss_scale=16, train_wall=565, gb_free=3.3, wall=80236
2022-02-19 06:42:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 06:50:46 | INFO | train_inner | epoch 018:    198 / 788 loss=5.301, nll_loss=4.906, ppl=29.97, wps=10967.1, ups=0.17, wpb=65536, bsz=128, num_updates=13500, lr=0.000272166, gnorm=0.558, loss_scale=8, train_wall=573, gb_free=3.3, wall=80833
2022-02-19 07:00:36 | INFO | train_inner | epoch 018:    298 / 788 loss=5.32, nll_loss=4.925, ppl=30.39, wps=11098.3, ups=0.17, wpb=65536, bsz=128, num_updates=13600, lr=0.000271163, gnorm=0.533, loss_scale=16, train_wall=567, gb_free=3.3, wall=81424
2022-02-19 07:04:33 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 07:10:34 | INFO | train_inner | epoch 018:    399 / 788 loss=5.347, nll_loss=4.953, ppl=30.96, wps=10972.4, ups=0.17, wpb=65536, bsz=128, num_updates=13700, lr=0.000270172, gnorm=0.558, loss_scale=8, train_wall=573, gb_free=3.3, wall=82021
2022-02-19 07:20:25 | INFO | train_inner | epoch 018:    499 / 788 loss=5.364, nll_loss=4.97, ppl=31.35, wps=11076, ups=0.17, wpb=65536, bsz=128, num_updates=13800, lr=0.000269191, gnorm=0.547, loss_scale=16, train_wall=568, gb_free=3.3, wall=82613
2022-02-19 07:29:59 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 07:30:22 | INFO | train_inner | epoch 018:    600 / 788 loss=5.359, nll_loss=4.965, ppl=31.24, wps=10974.2, ups=0.17, wpb=65536, bsz=128, num_updates=13900, lr=0.000268221, gnorm=0.56, loss_scale=16, train_wall=574, gb_free=3.3, wall=83210
2022-02-19 07:31:45 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 07:40:19 | INFO | train_inner | epoch 018:    701 / 788 loss=5.39, nll_loss=4.997, ppl=31.93, wps=10983.8, ups=0.17, wpb=65536, bsz=128, num_updates=14000, lr=0.000267261, gnorm=0.564, loss_scale=8, train_wall=573, gb_free=3.3, wall=83806
2022-02-19 07:48:50 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 07:48:58 | INFO | valid | epoch 018 | valid on 'valid' subset | loss 5.854 | nll_loss 5.464 | ppl 44.14 | wps 27211.2 | wpb 510.9 | bsz 1 | num_updates 14087 | best_loss 5.851
2022-02-19 07:48:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 14087 updates
2022-02-19 07:48:58 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint18.pt
2022-02-19 07:49:04 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint18.pt
2022-02-19 07:49:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint18.pt (epoch 18 @ 14087 updates, score 5.854) (writing took 12.65915468800813 seconds)
2022-02-19 07:49:11 | INFO | fairseq_cli.train | end of epoch 18 (average epoch stats below)
2022-02-19 07:49:11 | INFO | train | epoch 018 | loss 5.345 | nll_loss 4.95 | ppl 30.92 | wps 10980.6 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 14087 | lr 0.000266435 | gnorm 0.552 | loss_scale 16 | train_wall 4470 | gb_free 3.3 | wall 84339
2022-02-19 07:49:11 | INFO | fairseq.trainer | begin training epoch 19
2022-02-19 07:49:11 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 07:50:29 | INFO | train_inner | epoch 019:     13 / 788 loss=5.372, nll_loss=4.979, ppl=31.54, wps=10698.1, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=14100, lr=0.000266312, gnorm=0.541, loss_scale=16, train_wall=565, gb_free=3.3, wall=84416
2022-02-19 07:57:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 07:58:10 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 08:00:31 | INFO | train_inner | epoch 019:    115 / 788 loss=5.252, nll_loss=4.856, ppl=28.95, wps=10883.1, ups=0.17, wpb=65536, bsz=128, num_updates=14200, lr=0.000265372, gnorm=0.558, loss_scale=8, train_wall=578, gb_free=3.3, wall=85018
2022-02-19 08:10:22 | INFO | train_inner | epoch 019:    215 / 788 loss=5.274, nll_loss=4.878, ppl=29.4, wps=11080.4, ups=0.17, wpb=65536, bsz=128, num_updates=14300, lr=0.000264443, gnorm=0.555, loss_scale=8, train_wall=568, gb_free=3.3, wall=85610
2022-02-19 08:10:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 08:20:19 | INFO | train_inner | epoch 019:    316 / 788 loss=5.297, nll_loss=4.901, ppl=29.89, wps=10995, ups=0.17, wpb=65536, bsz=128, num_updates=14400, lr=0.000263523, gnorm=0.557, loss_scale=8, train_wall=572, gb_free=3.3, wall=86206
2022-02-19 08:30:10 | INFO | train_inner | epoch 019:    416 / 788 loss=5.308, nll_loss=4.913, ppl=30.13, wps=11084.7, ups=0.17, wpb=65534.7, bsz=128, num_updates=14500, lr=0.000262613, gnorm=0.562, loss_scale=16, train_wall=568, gb_free=3.3, wall=86797
2022-02-19 08:36:10 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 08:40:06 | INFO | train_inner | epoch 019:    517 / 788 loss=5.338, nll_loss=4.944, ppl=30.78, wps=10985.8, ups=0.17, wpb=65536, bsz=128, num_updates=14600, lr=0.000261712, gnorm=0.575, loss_scale=16, train_wall=573, gb_free=3.3, wall=87394
2022-02-19 08:48:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 08:50:03 | INFO | train_inner | epoch 019:    618 / 788 loss=5.34, nll_loss=4.946, ppl=30.83, wps=10980, ups=0.17, wpb=65536, bsz=128, num_updates=14700, lr=0.00026082, gnorm=0.549, loss_scale=16, train_wall=573, gb_free=3.3, wall=87991
2022-02-19 08:54:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 09:00:01 | INFO | train_inner | epoch 019:    719 / 788 loss=5.355, nll_loss=4.961, ppl=31.14, wps=10969.4, ups=0.17, wpb=65536, bsz=128, num_updates=14800, lr=0.000259938, gnorm=0.565, loss_scale=8, train_wall=574, gb_free=3.3, wall=88588
2022-02-19 09:06:46 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 09:06:54 | INFO | valid | epoch 019 | valid on 'valid' subset | loss 5.844 | nll_loss 5.457 | ppl 43.92 | wps 27221.6 | wpb 510.9 | bsz 1 | num_updates 14869 | best_loss 5.844
2022-02-19 09:06:54 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 14869 updates
2022-02-19 09:06:54 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint19.pt
2022-02-19 09:07:00 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint19.pt
2022-02-19 09:07:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint19.pt (epoch 19 @ 14869 updates, score 5.844) (writing took 19.475243509747088 seconds)
2022-02-19 09:07:14 | INFO | fairseq_cli.train | end of epoch 19 (average epoch stats below)
2022-02-19 09:07:14 | INFO | train | epoch 019 | loss 5.313 | nll_loss 4.918 | ppl 30.23 | wps 10938.1 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 14869 | lr 0.000259334 | gnorm 0.56 | loss_scale 8 | train_wall 4470 | gb_free 3.3 | wall 89021
2022-02-19 09:07:14 | INFO | fairseq.trainer | begin training epoch 20
2022-02-19 09:07:14 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 09:10:18 | INFO | train_inner | epoch 020:     31 / 788 loss=5.318, nll_loss=4.923, ppl=30.33, wps=10572.7, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=14900, lr=0.000259064, gnorm=0.552, loss_scale=16, train_wall=566, gb_free=3.3, wall=89205
2022-02-19 09:16:06 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 09:20:14 | INFO | train_inner | epoch 020:    132 / 788 loss=5.223, nll_loss=4.825, ppl=28.35, wps=10987.1, ups=0.17, wpb=65536, bsz=128, num_updates=15000, lr=0.000258199, gnorm=0.556, loss_scale=8, train_wall=573, gb_free=3.3, wall=89802
2022-02-19 09:30:06 | INFO | train_inner | epoch 020:    232 / 788 loss=5.249, nll_loss=4.852, ppl=28.88, wps=11076.6, ups=0.17, wpb=65536, bsz=128, num_updates=15100, lr=0.000257343, gnorm=0.545, loss_scale=16, train_wall=568, gb_free=3.3, wall=90393
2022-02-19 09:39:57 | INFO | train_inner | epoch 020:    332 / 788 loss=5.259, nll_loss=4.862, ppl=29.07, wps=11089.7, ups=0.17, wpb=65536, bsz=128, num_updates=15200, lr=0.000256495, gnorm=0.58, loss_scale=16, train_wall=567, gb_free=3.3, wall=90984
2022-02-19 09:41:49 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 09:45:51 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 09:50:00 | INFO | train_inner | epoch 020:    434 / 788 loss=5.287, nll_loss=4.89, ppl=29.66, wps=10867.3, ups=0.17, wpb=65534.7, bsz=128, num_updates=15300, lr=0.000255655, gnorm=0.549, loss_scale=8, train_wall=579, gb_free=3.3, wall=91587
2022-02-19 09:58:40 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 09:59:56 | INFO | train_inner | epoch 020:    535 / 788 loss=5.307, nll_loss=4.912, ppl=30.11, wps=10983.9, ups=0.17, wpb=65536, bsz=128, num_updates=15400, lr=0.000254824, gnorm=0.559, loss_scale=8, train_wall=573, gb_free=3.3, wall=92184
2022-02-19 10:09:48 | INFO | train_inner | epoch 020:    635 / 788 loss=5.319, nll_loss=4.924, ppl=30.36, wps=11082.4, ups=0.17, wpb=65536, bsz=128, num_updates=15500, lr=0.000254, gnorm=0.568, loss_scale=8, train_wall=568, gb_free=3.3, wall=92775
2022-02-19 10:15:31 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 10:19:44 | INFO | train_inner | epoch 020:    736 / 788 loss=5.346, nll_loss=4.952, ppl=30.94, wps=10984.6, ups=0.17, wpb=65536, bsz=128, num_updates=15600, lr=0.000253185, gnorm=0.568, loss_scale=8, train_wall=573, gb_free=3.3, wall=93372
2022-02-19 10:24:49 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 10:24:57 | INFO | valid | epoch 020 | valid on 'valid' subset | loss 5.839 | nll_loss 5.45 | ppl 43.7 | wps 27218.4 | wpb 510.9 | bsz 1 | num_updates 15652 | best_loss 5.839
2022-02-19 10:24:57 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 15652 updates
2022-02-19 10:24:57 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint20.pt
2022-02-19 10:25:03 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint20.pt
2022-02-19 10:25:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint20.pt (epoch 20 @ 15652 updates, score 5.839) (writing took 19.51616559177637 seconds)
2022-02-19 10:25:17 | INFO | fairseq_cli.train | end of epoch 20 (average epoch stats below)
2022-02-19 10:25:17 | INFO | train | epoch 020 | loss 5.285 | nll_loss 4.889 | ppl 29.63 | wps 10951 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 15652 | lr 0.000252764 | gnorm 0.56 | loss_scale 8 | train_wall 4469 | gb_free 3.3 | wall 93704
2022-02-19 10:25:17 | INFO | fairseq.trainer | begin training epoch 21
2022-02-19 10:25:17 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 10:30:01 | INFO | train_inner | epoch 021:     48 / 788 loss=5.269, nll_loss=4.873, ppl=29.3, wps=10587.9, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=15700, lr=0.000252377, gnorm=0.573, loss_scale=16, train_wall=565, gb_free=3.3, wall=93988
2022-02-19 10:39:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 10:39:57 | INFO | train_inner | epoch 021:    149 / 788 loss=5.201, nll_loss=4.802, ppl=27.9, wps=10985.9, ups=0.17, wpb=65536, bsz=128, num_updates=15800, lr=0.000251577, gnorm=0.576, loss_scale=8, train_wall=573, gb_free=3.3, wall=94584
2022-02-19 10:49:48 | INFO | train_inner | epoch 021:    249 / 788 loss=5.229, nll_loss=4.831, ppl=28.47, wps=11085.6, ups=0.17, wpb=65536, bsz=128, num_updates=15900, lr=0.000250785, gnorm=0.58, loss_scale=8, train_wall=568, gb_free=3.3, wall=95176
2022-02-19 10:59:40 | INFO | train_inner | epoch 021:    349 / 788 loss=5.247, nll_loss=4.85, ppl=28.83, wps=11076.8, ups=0.17, wpb=65536, bsz=128, num_updates=16000, lr=0.00025, gnorm=0.561, loss_scale=16, train_wall=568, gb_free=3.3, wall=95767
2022-02-19 11:04:30 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 11:09:37 | INFO | train_inner | epoch 021:    450 / 788 loss=5.27, nll_loss=4.873, ppl=29.3, wps=10974.9, ups=0.17, wpb=65536, bsz=128, num_updates=16100, lr=0.000249222, gnorm=0.585, loss_scale=8, train_wall=573, gb_free=3.3, wall=96364
2022-02-19 11:19:27 | INFO | train_inner | epoch 021:    550 / 788 loss=5.277, nll_loss=4.881, ppl=29.46, wps=11103.2, ups=0.17, wpb=65536, bsz=128, num_updates=16200, lr=0.000248452, gnorm=0.561, loss_scale=16, train_wall=567, gb_free=3.3, wall=96955
2022-02-19 11:22:31 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 11:29:25 | INFO | train_inner | epoch 021:    651 / 788 loss=5.299, nll_loss=4.903, ppl=29.92, wps=10965.6, ups=0.17, wpb=65536, bsz=128, num_updates=16300, lr=0.000247689, gnorm=0.594, loss_scale=8, train_wall=574, gb_free=3.3, wall=97552
2022-02-19 11:39:16 | INFO | train_inner | epoch 021:    751 / 788 loss=5.31, nll_loss=4.915, ppl=30.16, wps=11091.1, ups=0.17, wpb=65534.7, bsz=128, num_updates=16400, lr=0.000246932, gnorm=0.56, loss_scale=16, train_wall=568, gb_free=3.3, wall=98143
2022-02-19 11:41:08 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 11:42:51 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 11:43:01 | INFO | valid | epoch 021 | valid on 'valid' subset | loss 5.835 | nll_loss 5.444 | ppl 43.53 | wps 22135.1 | wpb 510.9 | bsz 1 | num_updates 16436 | best_loss 5.835
2022-02-19 11:43:01 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 16436 updates
2022-02-19 11:43:01 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint21.pt
2022-02-19 11:43:07 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint21.pt
2022-02-19 11:43:21 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint21.pt (epoch 21 @ 16436 updates, score 5.835) (writing took 19.982455752789974 seconds)
2022-02-19 11:43:21 | INFO | fairseq_cli.train | end of epoch 21 (average epoch stats below)
2022-02-19 11:43:21 | INFO | train | epoch 021 | loss 5.259 | nll_loss 4.862 | ppl 29.09 | wps 10962.1 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 16436 | lr 0.000246662 | gnorm 0.576 | loss_scale 8 | train_wall 4469 | gb_free 3.3 | wall 98389
2022-02-19 11:43:21 | INFO | fairseq.trainer | begin training epoch 22
2022-02-19 11:43:21 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 11:49:39 | INFO | train_inner | epoch 022:     64 / 788 loss=5.211, nll_loss=4.812, ppl=28.1, wps=10459.4, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=16500, lr=0.000246183, gnorm=0.587, loss_scale=8, train_wall=570, gb_free=3.3, wall=98767
2022-02-19 11:59:30 | INFO | train_inner | epoch 022:    164 / 788 loss=5.178, nll_loss=4.778, ppl=27.44, wps=11094.8, ups=0.17, wpb=65536, bsz=128, num_updates=16600, lr=0.00024544, gnorm=0.563, loss_scale=16, train_wall=567, gb_free=3.3, wall=99358
2022-02-19 12:04:50 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 12:09:27 | INFO | train_inner | epoch 022:    265 / 788 loss=5.203, nll_loss=4.804, ppl=27.93, wps=10979.1, ups=0.17, wpb=65536, bsz=128, num_updates=16700, lr=0.000244704, gnorm=0.583, loss_scale=8, train_wall=573, gb_free=3.3, wall=99955
2022-02-19 12:19:19 | INFO | train_inner | epoch 022:    365 / 788 loss=5.234, nll_loss=4.836, ppl=28.57, wps=11078.9, ups=0.17, wpb=65534.7, bsz=128, num_updates=16800, lr=0.000243975, gnorm=0.589, loss_scale=16, train_wall=568, gb_free=3.3, wall=100546
2022-02-19 12:19:42 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 12:29:16 | INFO | train_inner | epoch 022:    466 / 788 loss=5.245, nll_loss=4.847, ppl=28.78, wps=10969.3, ups=0.17, wpb=65536, bsz=128, num_updates=16900, lr=0.000243252, gnorm=0.582, loss_scale=8, train_wall=573, gb_free=3.3, wall=101144
2022-02-19 12:39:07 | INFO | train_inner | epoch 022:    566 / 788 loss=5.25, nll_loss=4.853, ppl=28.89, wps=11098.1, ups=0.17, wpb=65536, bsz=128, num_updates=17000, lr=0.000242536, gnorm=0.58, loss_scale=16, train_wall=567, gb_free=3.3, wall=101734
2022-02-19 12:45:01 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 12:49:05 | INFO | train_inner | epoch 022:    667 / 788 loss=5.276, nll_loss=4.88, ppl=29.44, wps=10952.7, ups=0.17, wpb=65536, bsz=128, num_updates=17100, lr=0.000241825, gnorm=0.573, loss_scale=16, train_wall=574, gb_free=3.3, wall=102332
2022-02-19 12:57:45 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 12:59:02 | INFO | train_inner | epoch 022:    768 / 788 loss=5.298, nll_loss=4.903, ppl=29.91, wps=10974.7, ups=0.17, wpb=65536, bsz=128, num_updates=17200, lr=0.000241121, gnorm=0.563, loss_scale=16, train_wall=573, gb_free=3.3, wall=102930
2022-02-19 13:00:19 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 13:00:58 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 13:01:06 | INFO | valid | epoch 022 | valid on 'valid' subset | loss 5.83 | nll_loss 5.438 | ppl 43.36 | wps 27279.9 | wpb 510.9 | bsz 1 | num_updates 17219 | best_loss 5.83
2022-02-19 13:01:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 17219 updates
2022-02-19 13:01:06 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint22.pt
2022-02-19 13:01:12 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint22.pt
2022-02-19 13:01:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint22.pt (epoch 22 @ 17219 updates, score 5.83) (writing took 19.53882206324488 seconds)
2022-02-19 13:01:26 | INFO | fairseq_cli.train | end of epoch 22 (average epoch stats below)
2022-02-19 13:01:26 | INFO | train | epoch 022 | loss 5.235 | nll_loss 4.837 | ppl 28.58 | wps 10947.5 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 17219 | lr 0.000240988 | gnorm 0.577 | loss_scale 8 | train_wall 4471 | gb_free 3.3 | wall 103073
2022-02-19 13:01:26 | INFO | fairseq.trainer | begin training epoch 23
2022-02-19 13:01:26 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 13:09:24 | INFO | train_inner | epoch 023:     81 / 788 loss=5.175, nll_loss=4.776, ppl=27.4, wps=10482.3, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=17300, lr=0.000240424, gnorm=0.576, loss_scale=8, train_wall=571, gb_free=3.3, wall=103552
2022-02-19 13:16:41 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 13:19:21 | INFO | train_inner | epoch 023:    182 / 788 loss=5.168, nll_loss=4.769, ppl=27.26, wps=10990.4, ups=0.17, wpb=65536, bsz=128, num_updates=17400, lr=0.000239732, gnorm=0.575, loss_scale=8, train_wall=573, gb_free=3.3, wall=104148
2022-02-19 13:29:12 | INFO | train_inner | epoch 023:    282 / 788 loss=5.182, nll_loss=4.782, ppl=27.52, wps=11082.7, ups=0.17, wpb=65536, bsz=128, num_updates=17500, lr=0.000239046, gnorm=0.564, loss_scale=8, train_wall=568, gb_free=3.3, wall=104740
2022-02-19 13:32:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 13:39:09 | INFO | train_inner | epoch 023:    383 / 788 loss=5.199, nll_loss=4.8, ppl=27.87, wps=10985.7, ups=0.17, wpb=65536, bsz=128, num_updates=17600, lr=0.000238366, gnorm=0.579, loss_scale=8, train_wall=573, gb_free=3.3, wall=105336
2022-02-19 13:49:00 | INFO | train_inner | epoch 023:    483 / 788 loss=5.227, nll_loss=4.829, ppl=28.42, wps=11079.4, ups=0.17, wpb=65536, bsz=128, num_updates=17700, lr=0.000237691, gnorm=0.585, loss_scale=16, train_wall=568, gb_free=3.3, wall=105928
2022-02-19 13:57:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 13:58:57 | INFO | train_inner | epoch 023:    584 / 788 loss=5.239, nll_loss=4.841, ppl=28.67, wps=10987.2, ups=0.17, wpb=65534.7, bsz=128, num_updates=17800, lr=0.000237023, gnorm=0.565, loss_scale=16, train_wall=573, gb_free=3.3, wall=106524
2022-02-19 14:05:44 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 14:08:54 | INFO | train_inner | epoch 023:    685 / 788 loss=5.259, nll_loss=4.861, ppl=29.07, wps=10971.3, ups=0.17, wpb=65536, bsz=128, num_updates=17900, lr=0.00023636, gnorm=0.57, loss_scale=8, train_wall=574, gb_free=3.3, wall=107121
2022-02-19 14:18:45 | INFO | train_inner | epoch 023:    785 / 788 loss=5.269, nll_loss=4.872, ppl=29.29, wps=11094.7, ups=0.17, wpb=65536, bsz=128, num_updates=18000, lr=0.000235702, gnorm=0.575, loss_scale=16, train_wall=567, gb_free=3.3, wall=107712
2022-02-19 14:19:00 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 14:19:08 | INFO | valid | epoch 023 | valid on 'valid' subset | loss 5.835 | nll_loss 5.443 | ppl 43.52 | wps 27211.7 | wpb 510.9 | bsz 1 | num_updates 18003 | best_loss 5.83
2022-02-19 14:19:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 23 @ 18003 updates
2022-02-19 14:19:08 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint23.pt
2022-02-19 14:19:13 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint23.pt
2022-02-19 14:19:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint23.pt (epoch 23 @ 18003 updates, score 5.835) (writing took 12.696506975218654 seconds)
2022-02-19 14:19:20 | INFO | fairseq_cli.train | end of epoch 23 (average epoch stats below)
2022-02-19 14:19:20 | INFO | train | epoch 023 | loss 5.213 | nll_loss 4.815 | ppl 28.14 | wps 10984.5 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 18003 | lr 0.000235683 | gnorm 0.573 | loss_scale 16 | train_wall 4469 | gb_free 3.3 | wall 107748
2022-02-19 14:19:21 | INFO | fairseq.trainer | begin training epoch 24
2022-02-19 14:19:21 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 14:24:46 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 14:29:00 | INFO | train_inner | epoch 024:     98 / 788 loss=5.122, nll_loss=4.72, ppl=26.36, wps=10598.9, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=18100, lr=0.00023505, gnorm=0.58, loss_scale=8, train_wall=571, gb_free=3.3, wall=108328
2022-02-19 14:38:52 | INFO | train_inner | epoch 024:    198 / 788 loss=5.138, nll_loss=4.737, ppl=26.67, wps=11078.9, ups=0.17, wpb=65536, bsz=128, num_updates=18200, lr=0.000234404, gnorm=0.586, loss_scale=16, train_wall=568, gb_free=3.3, wall=108919
2022-02-19 14:40:26 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 14:48:50 | INFO | train_inner | epoch 024:    299 / 788 loss=5.176, nll_loss=4.776, ppl=27.4, wps=10957.6, ups=0.17, wpb=65536, bsz=128, num_updates=18300, lr=0.000233762, gnorm=0.574, loss_scale=8, train_wall=574, gb_free=3.3, wall=109517
2022-02-19 14:58:40 | INFO | train_inner | epoch 024:    399 / 788 loss=5.187, nll_loss=4.787, ppl=27.61, wps=11094.9, ups=0.17, wpb=65534.7, bsz=128, num_updates=18400, lr=0.000233126, gnorm=0.581, loss_scale=16, train_wall=567, gb_free=3.3, wall=110108
2022-02-19 15:02:43 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 15:08:38 | INFO | train_inner | epoch 024:    500 / 788 loss=5.213, nll_loss=4.814, ppl=28.14, wps=10959.3, ups=0.17, wpb=65536, bsz=128, num_updates=18500, lr=0.000232495, gnorm=0.58, loss_scale=8, train_wall=574, gb_free=3.3, wall=110706
2022-02-19 15:18:00 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 15:18:35 | INFO | train_inner | epoch 024:    601 / 788 loss=5.222, nll_loss=4.823, ppl=28.31, wps=10985.4, ups=0.17, wpb=65536, bsz=128, num_updates=18600, lr=0.000231869, gnorm=0.597, loss_scale=8, train_wall=573, gb_free=3.3, wall=111302
2022-02-19 15:28:27 | INFO | train_inner | epoch 024:    701 / 788 loss=5.243, nll_loss=4.845, ppl=28.74, wps=11064.4, ups=0.17, wpb=65536, bsz=128, num_updates=18700, lr=0.000231249, gnorm=0.577, loss_scale=8, train_wall=568, gb_free=3.3, wall=111895
2022-02-19 15:32:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 15:36:59 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 15:37:07 | INFO | valid | epoch 024 | valid on 'valid' subset | loss 5.842 | nll_loss 5.449 | ppl 43.67 | wps 27231.5 | wpb 510.9 | bsz 1 | num_updates 18786 | best_loss 5.83
2022-02-19 15:37:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 18786 updates
2022-02-19 15:37:07 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint24.pt
2022-02-19 15:37:12 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint24.pt
2022-02-19 15:37:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint24.pt (epoch 24 @ 18786 updates, score 5.842) (writing took 13.278631082735956 seconds)
2022-02-19 15:37:20 | INFO | fairseq_cli.train | end of epoch 24 (average epoch stats below)
2022-02-19 15:37:20 | INFO | train | epoch 024 | loss 5.193 | nll_loss 4.794 | ppl 27.73 | wps 10959.4 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 18786 | lr 0.000230719 | gnorm 0.584 | loss_scale 8 | train_wall 4471 | gb_free 3.3 | wall 112427
2022-02-19 15:37:20 | INFO | fairseq.trainer | begin training epoch 25
2022-02-19 15:37:20 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 15:38:43 | INFO | train_inner | epoch 025:     14 / 788 loss=5.228, nll_loss=4.83, ppl=28.44, wps=10603.3, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=18800, lr=0.000230633, gnorm=0.596, loss_scale=8, train_wall=570, gb_free=3.3, wall=112510
2022-02-19 15:48:34 | INFO | train_inner | epoch 025:    114 / 788 loss=5.107, nll_loss=4.705, ppl=26.08, wps=11071.1, ups=0.17, wpb=65536, bsz=128, num_updates=18900, lr=0.000230022, gnorm=0.57, loss_scale=16, train_wall=568, gb_free=3.3, wall=113102
2022-02-19 15:58:02 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 15:58:32 | INFO | train_inner | epoch 025:    215 / 788 loss=5.135, nll_loss=4.734, ppl=26.61, wps=10974.9, ups=0.17, wpb=65536, bsz=128, num_updates=19000, lr=0.000229416, gnorm=0.585, loss_scale=16, train_wall=573, gb_free=3.3, wall=113699
2022-02-19 16:06:40 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 16:08:26 | INFO | train_inner | epoch 025:    316 / 788 loss=5.155, nll_loss=4.755, ppl=27, wps=11023, ups=0.17, wpb=65536, bsz=128, num_updates=19100, lr=0.000228814, gnorm=0.58, loss_scale=8, train_wall=571, gb_free=3.3, wall=114294
2022-02-19 16:18:16 | INFO | train_inner | epoch 025:    416 / 788 loss=5.173, nll_loss=4.773, ppl=27.34, wps=11120.5, ups=0.17, wpb=65536, bsz=128, num_updates=19200, lr=0.000228218, gnorm=0.595, loss_scale=8, train_wall=566, gb_free=3.3, wall=114883
2022-02-19 16:24:45 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 16:28:11 | INFO | train_inner | epoch 025:    517 / 788 loss=5.193, nll_loss=4.793, ppl=27.73, wps=11002.6, ups=0.17, wpb=65536, bsz=128, num_updates=19300, lr=0.000227626, gnorm=0.605, loss_scale=8, train_wall=572, gb_free=3.3, wall=115479
2022-02-19 16:38:02 | INFO | train_inner | epoch 025:    617 / 788 loss=5.204, nll_loss=4.805, ppl=27.95, wps=11092.6, ups=0.17, wpb=65536, bsz=128, num_updates=19400, lr=0.000227038, gnorm=0.577, loss_scale=16, train_wall=567, gb_free=3.3, wall=116069
2022-02-19 16:47:52 | INFO | train_inner | epoch 025:    717 / 788 loss=5.215, nll_loss=4.816, ppl=28.17, wps=11110.5, ups=0.17, wpb=65534.7, bsz=128, num_updates=19500, lr=0.000226455, gnorm=0.584, loss_scale=16, train_wall=567, gb_free=3.3, wall=116659
2022-02-19 16:50:01 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 16:54:47 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 16:54:56 | INFO | valid | epoch 025 | valid on 'valid' subset | loss 5.843 | nll_loss 5.453 | ppl 43.8 | wps 27230.9 | wpb 510.9 | bsz 1 | num_updates 19570 | best_loss 5.83
2022-02-19 16:54:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 19570 updates
2022-02-19 16:54:56 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint25.pt
2022-02-19 16:55:01 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint25.pt
2022-02-19 16:55:08 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint25.pt (epoch 25 @ 19570 updates, score 5.843) (writing took 12.600428651086986 seconds)
2022-02-19 16:55:08 | INFO | fairseq_cli.train | end of epoch 25 (average epoch stats below)
2022-02-19 16:55:08 | INFO | train | epoch 025 | loss 5.173 | nll_loss 4.773 | ppl 27.35 | wps 10999.8 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 19570 | lr 0.00022605 | gnorm 0.586 | loss_scale 16 | train_wall 4464 | gb_free 3.3 | wall 117096
2022-02-19 16:55:08 | INFO | fairseq.trainer | begin training epoch 26
2022-02-19 16:55:08 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 16:58:05 | INFO | train_inner | epoch 026:     30 / 788 loss=5.186, nll_loss=4.787, ppl=27.61, wps=10633.7, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=19600, lr=0.000225877, gnorm=0.593, loss_scale=16, train_wall=569, gb_free=3.3, wall=117273
2022-02-19 17:03:00 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 17:08:01 | INFO | train_inner | epoch 026:    131 / 788 loss=5.089, nll_loss=4.687, ppl=25.75, wps=11002.8, ups=0.17, wpb=65536, bsz=128, num_updates=19700, lr=0.000225303, gnorm=0.577, loss_scale=16, train_wall=572, gb_free=3.3, wall=117868
2022-02-19 17:15:42 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 17:17:57 | INFO | train_inner | epoch 026:    232 / 788 loss=5.123, nll_loss=4.722, ppl=26.38, wps=10989.8, ups=0.17, wpb=65536, bsz=128, num_updates=19800, lr=0.000224733, gnorm=0.597, loss_scale=16, train_wall=573, gb_free=3.3, wall=118465
2022-02-19 17:22:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 17:27:52 | INFO | train_inner | epoch 026:    333 / 788 loss=5.138, nll_loss=4.737, ppl=26.66, wps=11015.5, ups=0.17, wpb=65536, bsz=128, num_updates=19900, lr=0.000224168, gnorm=0.574, loss_scale=8, train_wall=572, gb_free=3.3, wall=119060
2022-02-19 17:37:41 | INFO | train_inner | epoch 026:    433 / 788 loss=5.157, nll_loss=4.756, ppl=27.02, wps=11122.5, ups=0.17, wpb=65536, bsz=128, num_updates=20000, lr=0.000223607, gnorm=0.596, loss_scale=16, train_wall=566, gb_free=3.3, wall=119649
2022-02-19 17:47:31 | INFO | train_inner | epoch 026:    533 / 788 loss=5.174, nll_loss=4.774, ppl=27.36, wps=11107.2, ups=0.17, wpb=65534.7, bsz=128, num_updates=20100, lr=0.00022305, gnorm=0.593, loss_scale=32, train_wall=567, gb_free=3.3, wall=120239
2022-02-19 17:47:43 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 17:50:04 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 17:57:32 | INFO | train_inner | epoch 026:    635 / 788 loss=5.192, nll_loss=4.793, ppl=27.72, wps=10912.3, ups=0.17, wpb=65536, bsz=128, num_updates=20200, lr=0.000222497, gnorm=0.618, loss_scale=8, train_wall=577, gb_free=3.3, wall=120839
2022-02-19 18:07:22 | INFO | train_inner | epoch 026:    735 / 788 loss=5.2, nll_loss=4.801, ppl=27.88, wps=11111.8, ups=0.17, wpb=65536, bsz=128, num_updates=20300, lr=0.000221948, gnorm=0.58, loss_scale=16, train_wall=567, gb_free=3.3, wall=121429
2022-02-19 18:12:32 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 18:12:40 | INFO | valid | epoch 026 | valid on 'valid' subset | loss 5.834 | nll_loss 5.441 | ppl 43.45 | wps 27273.4 | wpb 510.9 | bsz 1 | num_updates 20353 | best_loss 5.83
2022-02-19 18:12:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 20353 updates
2022-02-19 18:12:40 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint26.pt
2022-02-19 18:12:46 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint26.pt
2022-02-19 18:12:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint26.pt (epoch 26 @ 20353 updates, score 5.834) (writing took 12.880243500694633 seconds)
2022-02-19 18:12:53 | INFO | fairseq_cli.train | end of epoch 26 (average epoch stats below)
2022-02-19 18:12:53 | INFO | train | epoch 026 | loss 5.155 | nll_loss 4.755 | ppl 27 | wps 10993.7 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 20353 | lr 0.000221659 | gnorm 0.59 | loss_scale 16 | train_wall 4461 | gb_free 3.3 | wall 121760
2022-02-19 18:12:53 | INFO | fairseq.trainer | begin training epoch 27
2022-02-19 18:12:53 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 18:16:02 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 18:17:36 | INFO | train_inner | epoch 027:     48 / 788 loss=5.15, nll_loss=4.75, ppl=26.9, wps=10621.7, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=20400, lr=0.000221404, gnorm=0.579, loss_scale=16, train_wall=570, gb_free=3.3, wall=122043
2022-02-19 18:18:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 18:27:32 | INFO | train_inner | epoch 027:    149 / 788 loss=5.075, nll_loss=4.672, ppl=25.5, wps=10998, ups=0.17, wpb=65534.7, bsz=128, num_updates=20500, lr=0.000220863, gnorm=0.603, loss_scale=8, train_wall=572, gb_free=3.3, wall=122639
2022-02-19 18:32:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 18:37:28 | INFO | train_inner | epoch 027:    250 / 788 loss=5.1, nll_loss=4.698, ppl=25.95, wps=10996.1, ups=0.17, wpb=65536, bsz=128, num_updates=20600, lr=0.000220326, gnorm=0.589, loss_scale=8, train_wall=572, gb_free=3.3, wall=123235
2022-02-19 18:46:06 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 18:47:23 | INFO | train_inner | epoch 027:    351 / 788 loss=5.134, nll_loss=4.733, ppl=26.6, wps=11017.8, ups=0.17, wpb=65536, bsz=128, num_updates=20700, lr=0.000219793, gnorm=0.609, loss_scale=8, train_wall=572, gb_free=3.3, wall=123830
2022-02-19 18:57:13 | INFO | train_inner | epoch 027:    451 / 788 loss=5.143, nll_loss=4.742, ppl=26.77, wps=11102.6, ups=0.17, wpb=65536, bsz=128, num_updates=20800, lr=0.000219265, gnorm=0.593, loss_scale=8, train_wall=567, gb_free=3.3, wall=124420
2022-02-19 19:07:02 | INFO | train_inner | epoch 027:    551 / 788 loss=5.169, nll_loss=4.769, ppl=27.27, wps=11123.9, ups=0.17, wpb=65536, bsz=128, num_updates=20900, lr=0.000218739, gnorm=0.601, loss_scale=16, train_wall=566, gb_free=3.3, wall=125009
2022-02-19 19:11:33 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 19:16:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 19:17:03 | INFO | train_inner | epoch 027:    653 / 788 loss=5.17, nll_loss=4.77, ppl=27.28, wps=10900.9, ups=0.17, wpb=65536, bsz=128, num_updates=21000, lr=0.000218218, gnorm=0.592, loss_scale=8, train_wall=578, gb_free=3.3, wall=125611
2022-02-19 19:26:59 | INFO | train_inner | epoch 027:    753 / 788 loss=5.191, nll_loss=4.792, ppl=27.7, wps=10992.7, ups=0.17, wpb=65536, bsz=128, num_updates=21100, lr=0.0002177, gnorm=0.603, loss_scale=8, train_wall=571, gb_free=3.3, wall=126207
2022-02-19 19:30:30 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 19:30:40 | INFO | valid | epoch 027 | valid on 'valid' subset | loss 5.835 | nll_loss 5.448 | ppl 43.66 | wps 23208.5 | wpb 510.9 | bsz 1 | num_updates 21135 | best_loss 5.83
2022-02-19 19:30:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 21135 updates
2022-02-19 19:30:40 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint27.pt
2022-02-19 19:30:46 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint27.pt
2022-02-19 19:30:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint27.pt (epoch 27 @ 21135 updates, score 5.835) (writing took 14.45079293474555 seconds)
2022-02-19 19:30:54 | INFO | fairseq_cli.train | end of epoch 27 (average epoch stats below)
2022-02-19 19:30:54 | INFO | train | epoch 027 | loss 5.138 | nll_loss 4.737 | ppl 26.67 | wps 10941.3 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 21135 | lr 0.00021752 | gnorm 0.597 | loss_scale 16 | train_wall 4471 | gb_free 3.3 | wall 126442
2022-02-19 19:30:54 | INFO | fairseq.trainer | begin training epoch 28
2022-02-19 19:30:54 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 19:37:31 | INFO | train_inner | epoch 028:     65 / 788 loss=5.099, nll_loss=4.697, ppl=25.93, wps=10327.7, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=21200, lr=0.000217186, gnorm=0.595, loss_scale=16, train_wall=580, gb_free=3.3, wall=126839
2022-02-19 19:43:25 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 19:47:45 | INFO | train_inner | epoch 028:    166 / 788 loss=5.07, nll_loss=4.667, ppl=25.41, wps=10675.2, ups=0.16, wpb=65536, bsz=128, num_updates=21300, lr=0.000216676, gnorm=0.595, loss_scale=16, train_wall=586, gb_free=3.3, wall=127452
2022-02-19 19:56:15 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 19:57:44 | INFO | train_inner | epoch 028:    267 / 788 loss=5.086, nll_loss=4.684, ppl=25.7, wps=10933.7, ups=0.17, wpb=65536, bsz=128, num_updates=21400, lr=0.000216169, gnorm=0.594, loss_scale=16, train_wall=575, gb_free=3.3, wall=128052
2022-02-19 19:58:32 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 20:07:42 | INFO | train_inner | epoch 028:    368 / 788 loss=5.112, nll_loss=4.71, ppl=26.17, wps=10958.5, ups=0.17, wpb=65536, bsz=128, num_updates=21500, lr=0.000215666, gnorm=0.603, loss_scale=8, train_wall=574, gb_free=3.3, wall=128650
2022-02-19 20:17:10 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 20:17:40 | INFO | train_inner | epoch 028:    469 / 788 loss=5.131, nll_loss=4.729, ppl=26.53, wps=10973.6, ups=0.17, wpb=65536, bsz=128, num_updates=21600, lr=0.000215166, gnorm=0.615, loss_scale=8, train_wall=574, gb_free=3.3, wall=129247
2022-02-19 20:27:30 | INFO | train_inner | epoch 028:    569 / 788 loss=5.157, nll_loss=4.756, ppl=27.03, wps=11101.6, ups=0.17, wpb=65536, bsz=128, num_updates=21700, lr=0.000214669, gnorm=0.6, loss_scale=8, train_wall=567, gb_free=3.3, wall=129837
2022-02-19 20:37:20 | INFO | train_inner | epoch 028:    669 / 788 loss=5.161, nll_loss=4.76, ppl=27.1, wps=11100.6, ups=0.17, wpb=65534.7, bsz=128, num_updates=21800, lr=0.000214176, gnorm=0.6, loss_scale=16, train_wall=567, gb_free=3.3, wall=130428
2022-02-19 20:42:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 20:47:17 | INFO | train_inner | epoch 028:    770 / 788 loss=5.176, nll_loss=4.777, ppl=27.41, wps=10989.9, ups=0.17, wpb=65536, bsz=128, num_updates=21900, lr=0.000213687, gnorm=0.597, loss_scale=16, train_wall=573, gb_free=3.3, wall=131024
2022-02-19 20:49:00 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 20:49:08 | INFO | valid | epoch 028 | valid on 'valid' subset | loss 5.841 | nll_loss 5.449 | ppl 43.7 | wps 27082.7 | wpb 510.9 | bsz 1 | num_updates 21918 | best_loss 5.83
2022-02-19 20:49:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 21918 updates
2022-02-19 20:49:08 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint28.pt
2022-02-19 20:49:15 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint28.pt
2022-02-19 20:49:22 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint28.pt (epoch 28 @ 21918 updates, score 5.841) (writing took 13.537756910547614 seconds)
2022-02-19 20:49:22 | INFO | fairseq_cli.train | end of epoch 28 (average epoch stats below)
2022-02-19 20:49:22 | INFO | train | epoch 028 | loss 5.122 | nll_loss 4.721 | ppl 26.37 | wps 10894 | ups 0.17 | wpb 65497.3 | bsz 127.9 | num_updates 21918 | lr 0.000213599 | gnorm 0.601 | loss_scale 16 | train_wall 4494 | gb_free 3.3 | wall 131149
2022-02-19 20:49:22 | INFO | fairseq.trainer | begin training epoch 29
2022-02-19 20:49:22 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 20:55:46 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 20:57:32 | INFO | train_inner | epoch 029:     83 / 788 loss=5.074, nll_loss=4.67, ppl=25.47, wps=10602.4, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=22000, lr=0.000213201, gnorm=0.594, loss_scale=16, train_wall=570, gb_free=3.3, wall=131639
2022-02-19 21:07:22 | INFO | train_inner | epoch 029:    183 / 788 loss=5.053, nll_loss=4.649, ppl=25.09, wps=11105.4, ups=0.17, wpb=65534.7, bsz=128, num_updates=22100, lr=0.000212718, gnorm=0.6, loss_scale=16, train_wall=567, gb_free=3.3, wall=132230
2022-02-19 21:08:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 21:17:18 | INFO | train_inner | epoch 029:    284 / 788 loss=5.079, nll_loss=4.676, ppl=25.56, wps=10990.3, ups=0.17, wpb=65536, bsz=128, num_updates=22200, lr=0.000212238, gnorm=0.608, loss_scale=16, train_wall=573, gb_free=3.3, wall=132826
2022-02-19 21:21:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 21:27:14 | INFO | train_inner | epoch 029:    385 / 788 loss=5.104, nll_loss=4.702, ppl=26.03, wps=10995.1, ups=0.17, wpb=65536, bsz=128, num_updates=22300, lr=0.000211762, gnorm=0.602, loss_scale=16, train_wall=573, gb_free=3.3, wall=133422
2022-02-19 21:33:50 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 21:36:35 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 21:37:16 | INFO | train_inner | epoch 029:    487 / 788 loss=5.117, nll_loss=4.715, ppl=26.27, wps=10886.4, ups=0.17, wpb=65536, bsz=128, num_updates=22400, lr=0.000211289, gnorm=0.606, loss_scale=8, train_wall=578, gb_free=3.3, wall=134024
2022-02-19 21:47:09 | INFO | train_inner | epoch 029:    587 / 788 loss=5.129, nll_loss=4.728, ppl=26.5, wps=11059.5, ups=0.17, wpb=65536, bsz=128, num_updates=22500, lr=0.000210819, gnorm=0.592, loss_scale=8, train_wall=569, gb_free=3.3, wall=134616
2022-02-19 21:53:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 21:57:07 | INFO | train_inner | epoch 029:    688 / 788 loss=5.157, nll_loss=4.756, ppl=27.03, wps=10953.2, ups=0.17, wpb=65536, bsz=128, num_updates=22600, lr=0.000210352, gnorm=0.635, loss_scale=8, train_wall=574, gb_free=3.3, wall=135215
2022-02-19 22:06:37 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 22:07:05 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 22:07:14 | INFO | valid | epoch 029 | valid on 'valid' subset | loss 5.847 | nll_loss 5.454 | ppl 43.82 | wps 23274 | wpb 510.9 | bsz 1 | num_updates 22699 | best_loss 5.83
2022-02-19 22:07:14 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 22699 updates
2022-02-19 22:07:14 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint29.pt
2022-02-19 22:07:21 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint29.pt
2022-02-19 22:07:30 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint29.pt (epoch 29 @ 22699 updates, score 5.847) (writing took 15.553556438535452 seconds)
2022-02-19 22:07:30 | INFO | fairseq_cli.train | end of epoch 29 (average epoch stats below)
2022-02-19 22:07:30 | INFO | train | epoch 029 | loss 5.107 | nll_loss 4.705 | ppl 26.09 | wps 10911.8 | ups 0.17 | wpb 65497.2 | bsz 127.9 | num_updates 22699 | lr 0.000209892 | gnorm 0.605 | loss_scale 8 | train_wall 4476 | gb_free 3.3 | wall 135837
2022-02-19 22:07:30 | INFO | fairseq.trainer | begin training epoch 30
2022-02-19 22:07:30 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 22:07:36 | INFO | train_inner | epoch 030:      1 / 788 loss=5.163, nll_loss=4.762, ppl=27.14, wps=10376.1, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=22700, lr=0.000209888, gnorm=0.608, loss_scale=8, train_wall=578, gb_free=3.3, wall=135843
2022-02-19 22:17:51 | INFO | train_inner | epoch 030:    101 / 788 loss=5.018, nll_loss=4.614, ppl=24.48, wps=10653.2, ups=0.16, wpb=65536, bsz=128, num_updates=22800, lr=0.000209427, gnorm=0.61, loss_scale=8, train_wall=587, gb_free=3.3, wall=136459
2022-02-19 22:28:07 | INFO | train_inner | epoch 030:    201 / 788 loss=5.052, nll_loss=4.648, ppl=25.07, wps=10649.3, ups=0.16, wpb=65536, bsz=128, num_updates=22900, lr=0.000208969, gnorm=0.609, loss_scale=16, train_wall=587, gb_free=3.3, wall=137074
2022-02-19 22:33:20 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 22:38:28 | INFO | train_inner | epoch 030:    302 / 788 loss=5.074, nll_loss=4.67, ppl=25.46, wps=10552.4, ups=0.16, wpb=65534.7, bsz=128, num_updates=23000, lr=0.000208514, gnorm=0.596, loss_scale=16, train_wall=592, gb_free=3.3, wall=137695
2022-02-19 22:46:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-19 22:48:48 | INFO | train_inner | epoch 030:    403 / 788 loss=5.097, nll_loss=4.695, ppl=25.9, wps=10562.8, ups=0.16, wpb=65536, bsz=128, num_updates=23100, lr=0.000208063, gnorm=0.603, loss_scale=16, train_wall=592, gb_free=3.3, wall=138316
2022-02-19 22:51:03 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 22:59:09 | INFO | train_inner | epoch 030:    504 / 788 loss=5.107, nll_loss=4.704, ppl=26.07, wps=10561.5, ups=0.16, wpb=65536, bsz=128, num_updates=23200, lr=0.000207614, gnorm=0.622, loss_scale=8, train_wall=592, gb_free=3.3, wall=138936
2022-02-19 23:04:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 23:09:29 | INFO | train_inner | epoch 030:    605 / 788 loss=5.119, nll_loss=4.717, ppl=26.31, wps=10565.1, ups=0.16, wpb=65536, bsz=128, num_updates=23300, lr=0.000207168, gnorm=0.62, loss_scale=8, train_wall=592, gb_free=3.3, wall=139556
2022-02-19 23:19:43 | INFO | train_inner | epoch 030:    705 / 788 loss=5.139, nll_loss=4.738, ppl=26.68, wps=10665.5, ups=0.16, wpb=65536, bsz=128, num_updates=23400, lr=0.000206725, gnorm=0.613, loss_scale=16, train_wall=586, gb_free=3.3, wall=140171
2022-02-19 23:21:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 23:28:11 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-19 23:28:20 | INFO | valid | epoch 030 | valid on 'valid' subset | loss 5.839 | nll_loss 5.446 | ppl 43.58 | wps 23116.6 | wpb 510.9 | bsz 1 | num_updates 23482 | best_loss 5.83
2022-02-19 23:28:20 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 23482 updates
2022-02-19 23:28:20 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint30.pt
2022-02-19 23:28:27 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint30.pt
2022-02-19 23:28:36 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint30.pt (epoch 30 @ 23482 updates, score 5.839) (writing took 15.464812079444528 seconds)
2022-02-19 23:28:36 | INFO | fairseq_cli.train | end of epoch 30 (average epoch stats below)
2022-02-19 23:28:36 | INFO | train | epoch 030 | loss 5.093 | nll_loss 4.691 | ppl 25.82 | wps 10539.4 | ups 0.16 | wpb 65497.3 | bsz 127.9 | num_updates 23482 | lr 0.000206363 | gnorm 0.609 | loss_scale 8 | train_wall 4616 | gb_free 3.3 | wall 140703
2022-02-19 23:28:36 | INFO | fairseq.trainer | begin training epoch 31
2022-02-19 23:28:36 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-19 23:30:26 | INFO | train_inner | epoch 031:     18 / 788 loss=5.124, nll_loss=4.723, ppl=26.4, wps=10146.5, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=23500, lr=0.000206284, gnorm=0.599, loss_scale=8, train_wall=589, gb_free=3.3, wall=140814
2022-02-19 23:40:40 | INFO | train_inner | epoch 031:    118 / 788 loss=5.006, nll_loss=4.6, ppl=24.26, wps=10672, ups=0.16, wpb=65534.7, bsz=128, num_updates=23600, lr=0.000205847, gnorm=0.606, loss_scale=16, train_wall=586, gb_free=3.3, wall=141428
2022-02-19 23:43:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-19 23:50:53 | INFO | train_inner | epoch 031:    219 / 788 loss=5.032, nll_loss=4.627, ppl=24.72, wps=10705.1, ups=0.16, wpb=65536, bsz=128, num_updates=23700, lr=0.000205412, gnorm=0.625, loss_scale=8, train_wall=585, gb_free=3.3, wall=142040
2022-02-19 23:57:38 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 00:01:04 | INFO | train_inner | epoch 031:    320 / 788 loss=5.064, nll_loss=4.661, ppl=25.29, wps=10711.6, ups=0.16, wpb=65536, bsz=128, num_updates=23800, lr=0.00020498, gnorm=0.622, loss_scale=8, train_wall=585, gb_free=3.3, wall=142652
2022-02-20 00:11:11 | INFO | train_inner | epoch 031:    420 / 788 loss=5.085, nll_loss=4.682, ppl=25.67, wps=10812.4, ups=0.16, wpb=65536, bsz=128, num_updates=23900, lr=0.000204551, gnorm=0.628, loss_scale=16, train_wall=579, gb_free=3.3, wall=143258
2022-02-20 00:21:17 | INFO | train_inner | epoch 031:    520 / 788 loss=5.098, nll_loss=4.696, ppl=25.92, wps=10808.6, ups=0.16, wpb=65536, bsz=128, num_updates=24000, lr=0.000204124, gnorm=0.621, loss_scale=16, train_wall=580, gb_free=3.3, wall=143864
2022-02-20 00:23:42 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 00:31:29 | INFO | train_inner | epoch 031:    621 / 788 loss=5.124, nll_loss=4.723, ppl=26.41, wps=10701.2, ups=0.16, wpb=65536, bsz=128, num_updates=24100, lr=0.0002037, gnorm=0.616, loss_scale=16, train_wall=585, gb_free=3.3, wall=144477
2022-02-20 00:37:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 00:39:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 00:41:48 | INFO | train_inner | epoch 031:    723 / 788 loss=5.131, nll_loss=4.73, ppl=26.54, wps=10600.5, ups=0.16, wpb=65536, bsz=128, num_updates=24200, lr=0.000203279, gnorm=0.627, loss_scale=8, train_wall=591, gb_free=3.3, wall=145095
2022-02-20 00:48:19 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-20 00:48:28 | INFO | valid | epoch 031 | valid on 'valid' subset | loss 5.844 | nll_loss 5.45 | ppl 43.7 | wps 24067.3 | wpb 510.9 | bsz 1 | num_updates 24265 | best_loss 5.83
2022-02-20 00:48:28 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 24265 updates
2022-02-20 00:48:28 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint31.pt
2022-02-20 00:48:34 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint31.pt
2022-02-20 00:48:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint31.pt (epoch 31 @ 24265 updates, score 5.844) (writing took 13.896582852117717 seconds)
2022-02-20 00:48:42 | INFO | fairseq_cli.train | end of epoch 31 (average epoch stats below)
2022-02-20 00:48:42 | INFO | train | epoch 031 | loss 5.08 | nll_loss 4.677 | ppl 25.58 | wps 10670.7 | ups 0.16 | wpb 65497.3 | bsz 127.9 | num_updates 24265 | lr 0.000203006 | gnorm 0.62 | loss_scale 8 | train_wall 4571 | gb_free 3.3 | wall 145509
2022-02-20 00:48:42 | INFO | fairseq.trainer | begin training epoch 32
2022-02-20 00:48:42 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-20 00:52:14 | INFO | train_inner | epoch 032:     35 / 788 loss=5.081, nll_loss=4.678, ppl=25.6, wps=10414.6, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=24300, lr=0.00020286, gnorm=0.609, loss_scale=8, train_wall=577, gb_free=3.3, wall=145721
2022-02-20 00:53:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 01:02:26 | INFO | train_inner | epoch 032:    136 / 788 loss=5.007, nll_loss=4.601, ppl=24.27, wps=10707.9, ups=0.16, wpb=65536, bsz=128, num_updates=24400, lr=0.000202444, gnorm=0.605, loss_scale=8, train_wall=585, gb_free=3.3, wall=146333
2022-02-20 01:12:32 | INFO | train_inner | epoch 032:    236 / 788 loss=5.029, nll_loss=4.625, ppl=24.67, wps=10813.4, ups=0.16, wpb=65536, bsz=128, num_updates=24500, lr=0.000202031, gnorm=0.604, loss_scale=16, train_wall=579, gb_free=3.3, wall=146939
2022-02-20 01:19:26 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 01:22:47 | INFO | train_inner | epoch 032:    337 / 788 loss=5.049, nll_loss=4.645, ppl=25.01, wps=10655.3, ups=0.16, wpb=65536, bsz=128, num_updates=24600, lr=0.000201619, gnorm=0.617, loss_scale=16, train_wall=587, gb_free=3.3, wall=147555
2022-02-20 01:24:06 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 01:33:03 | INFO | train_inner | epoch 032:    438 / 788 loss=5.075, nll_loss=4.672, ppl=25.49, wps=10633.4, ups=0.16, wpb=65534.7, bsz=128, num_updates=24700, lr=0.000201211, gnorm=0.619, loss_scale=8, train_wall=588, gb_free=3.3, wall=148171
2022-02-20 01:37:44 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 01:43:20 | INFO | train_inner | epoch 032:    539 / 788 loss=5.094, nll_loss=4.691, ppl=25.83, wps=10631, ups=0.16, wpb=65536, bsz=128, num_updates=24800, lr=0.000200805, gnorm=0.622, loss_scale=8, train_wall=588, gb_free=3.3, wall=148787
2022-02-20 01:53:30 | INFO | train_inner | epoch 032:    639 / 788 loss=5.106, nll_loss=4.704, ppl=26.06, wps=10733.8, ups=0.16, wpb=65536, bsz=128, num_updates=24900, lr=0.000200401, gnorm=0.619, loss_scale=16, train_wall=582, gb_free=3.3, wall=149398
2022-02-20 02:01:24 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 02:03:43 | INFO | train_inner | epoch 032:    740 / 788 loss=5.113, nll_loss=4.711, ppl=26.19, wps=10699.1, ups=0.16, wpb=65536, bsz=128, num_updates=25000, lr=0.0002, gnorm=0.616, loss_scale=8, train_wall=586, gb_free=3.3, wall=150010
2022-02-20 02:08:31 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-20 02:08:40 | INFO | valid | epoch 032 | valid on 'valid' subset | loss 5.83 | nll_loss 5.439 | ppl 43.39 | wps 24165.3 | wpb 510.9 | bsz 1 | num_updates 25048 | best_loss 5.83
2022-02-20 02:08:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 25048 updates
2022-02-20 02:08:40 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint32.pt
2022-02-20 02:08:47 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint32.pt
2022-02-20 02:09:02 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint32.pt (epoch 32 @ 25048 updates, score 5.83) (writing took 21.45340814627707 seconds)
2022-02-20 02:09:02 | INFO | fairseq_cli.train | end of epoch 32 (average epoch stats below)
2022-02-20 02:09:02 | INFO | train | epoch 032 | loss 5.067 | nll_loss 4.664 | ppl 25.35 | wps 10639.8 | ups 0.16 | wpb 65497.3 | bsz 127.9 | num_updates 25048 | lr 0.000199808 | gnorm 0.614 | loss_scale 8 | train_wall 4574 | gb_free 3.3 | wall 150329
2022-02-20 02:09:02 | INFO | fairseq.trainer | begin training epoch 33
2022-02-20 02:09:02 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-20 02:14:17 | INFO | train_inner | epoch 033:     52 / 788 loss=5.039, nll_loss=4.635, ppl=24.85, wps=10286.9, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=25100, lr=0.000199601, gnorm=0.632, loss_scale=8, train_wall=577, gb_free=3.3, wall=150645
2022-02-20 02:24:24 | INFO | train_inner | epoch 033:    152 / 788 loss=4.992, nll_loss=4.587, ppl=24.03, wps=10800.5, ups=0.16, wpb=65536, bsz=128, num_updates=25200, lr=0.000199205, gnorm=0.623, loss_scale=16, train_wall=580, gb_free=3.3, wall=151251
2022-02-20 02:27:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 02:33:42 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 02:34:43 | INFO | train_inner | epoch 033:    254 / 788 loss=5.022, nll_loss=4.617, ppl=24.54, wps=10595.3, ups=0.16, wpb=65536, bsz=128, num_updates=25300, lr=0.000198811, gnorm=0.631, loss_scale=8, train_wall=591, gb_free=3.3, wall=151870
2022-02-20 02:44:49 | INFO | train_inner | epoch 033:    354 / 788 loss=5.045, nll_loss=4.64, ppl=24.94, wps=10811.6, ups=0.16, wpb=65536, bsz=128, num_updates=25400, lr=0.000198419, gnorm=0.632, loss_scale=8, train_wall=579, gb_free=3.3, wall=152476
2022-02-20 02:48:15 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 02:55:01 | INFO | train_inner | epoch 033:    455 / 788 loss=5.07, nll_loss=4.666, ppl=25.39, wps=10702.7, ups=0.16, wpb=65534.7, bsz=128, num_updates=25500, lr=0.00019803, gnorm=0.622, loss_scale=8, train_wall=585, gb_free=3.3, wall=153088
2022-02-20 03:05:16 | INFO | train_inner | epoch 033:    555 / 788 loss=5.084, nll_loss=4.681, ppl=25.65, wps=10662.9, ups=0.16, wpb=65536, bsz=128, num_updates=25600, lr=0.000197642, gnorm=0.626, loss_scale=16, train_wall=580, gb_free=3.3, wall=153703
2022-02-20 03:15:17 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 03:15:29 | INFO | train_inner | epoch 033:    656 / 788 loss=5.088, nll_loss=4.685, ppl=25.73, wps=10690.8, ups=0.16, wpb=65536, bsz=128, num_updates=25700, lr=0.000197257, gnorm=0.618, loss_scale=16, train_wall=586, gb_free=3.3, wall=154316
2022-02-20 03:17:12 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 03:25:41 | INFO | train_inner | epoch 033:    757 / 788 loss=5.118, nll_loss=4.716, ppl=26.28, wps=10698.2, ups=0.16, wpb=65536, bsz=128, num_updates=25800, lr=0.000196875, gnorm=0.62, loss_scale=8, train_wall=586, gb_free=3.3, wall=154929
2022-02-20 03:28:47 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-20 03:28:56 | INFO | valid | epoch 033 | valid on 'valid' subset | loss 5.84 | nll_loss 5.443 | ppl 43.5 | wps 24044.3 | wpb 510.9 | bsz 1 | num_updates 25831 | best_loss 5.83
2022-02-20 03:28:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 25831 updates
2022-02-20 03:28:56 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint33.pt
2022-02-20 03:29:03 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint33.pt
2022-02-20 03:29:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint33.pt (epoch 33 @ 25831 updates, score 5.84) (writing took 16.291164753958583 seconds)
2022-02-20 03:29:12 | INFO | fairseq_cli.train | end of epoch 33 (average epoch stats below)
2022-02-20 03:29:12 | INFO | train | epoch 033 | loss 5.055 | nll_loss 4.651 | ppl 25.12 | wps 10661.7 | ups 0.16 | wpb 65497.3 | bsz 127.9 | num_updates 25831 | lr 0.000196757 | gnorm 0.626 | loss_scale 8 | train_wall 4565 | gb_free 3.3 | wall 155139
2022-02-20 03:29:12 | INFO | fairseq.trainer | begin training epoch 34
2022-02-20 03:29:12 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-20 03:33:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 03:36:17 | INFO | train_inner | epoch 034:     70 / 788 loss=5.008, nll_loss=4.603, ppl=24.3, wps=10263.5, ups=0.16, wpb=65232.6, bsz=127.4, num_updates=25900, lr=0.000196494, gnorm=0.638, loss_scale=8, train_wall=583, gb_free=3.3, wall=155564
2022-02-20 03:46:25 | INFO | train_inner | epoch 034:    170 / 788 loss=4.987, nll_loss=4.581, ppl=23.93, wps=10774.6, ups=0.16, wpb=65536, bsz=128, num_updates=26000, lr=0.000196116, gnorm=0.631, loss_scale=16, train_wall=579, gb_free=3.3, wall=156173
2022-02-20 03:49:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 03:56:37 | INFO | train_inner | epoch 034:    271 / 788 loss=5.017, nll_loss=4.612, ppl=24.45, wps=10704.1, ups=0.16, wpb=65536, bsz=128, num_updates=26100, lr=0.00019574, gnorm=0.634, loss_scale=8, train_wall=585, gb_free=3.3, wall=156785
2022-02-20 04:06:44 | INFO | train_inner | epoch 034:    371 / 788 loss=5.022, nll_loss=4.617, ppl=24.53, wps=10809.7, ups=0.16, wpb=65536, bsz=128, num_updates=26200, lr=0.000195366, gnorm=0.638, loss_scale=16, train_wall=580, gb_free=3.3, wall=157391
2022-02-20 04:09:15 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 04:16:56 | INFO | train_inner | epoch 034:    472 / 788 loss=5.054, nll_loss=4.651, ppl=25.12, wps=10707.1, ups=0.16, wpb=65536, bsz=128, num_updates=26300, lr=0.000194994, gnorm=0.612, loss_scale=8, train_wall=585, gb_free=3.3, wall=158003
2022-02-20 04:22:43 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 04:27:09 | INFO | train_inner | epoch 034:    573 / 788 loss=5.078, nll_loss=4.675, ppl=25.54, wps=10678.1, ups=0.16, wpb=65536, bsz=128, num_updates=26400, lr=0.000194625, gnorm=0.64, loss_scale=8, train_wall=585, gb_free=3.3, wall=158617
2022-02-20 04:37:16 | INFO | train_inner | epoch 034:    673 / 788 loss=5.093, nll_loss=4.69, ppl=25.81, wps=10811.1, ups=0.16, wpb=65536, bsz=128, num_updates=26500, lr=0.000194257, gnorm=0.635, loss_scale=16, train_wall=580, gb_free=3.3, wall=159223
2022-02-20 04:41:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 04:47:28 | INFO | train_inner | epoch 034:    774 / 788 loss=5.105, nll_loss=4.702, ppl=26.03, wps=10706.5, ups=0.16, wpb=65536, bsz=128, num_updates=26600, lr=0.000193892, gnorm=0.627, loss_scale=8, train_wall=585, gb_free=3.3, wall=159835
2022-02-20 04:48:50 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-20 04:48:59 | INFO | valid | epoch 034 | valid on 'valid' subset | loss 5.84 | nll_loss 5.447 | ppl 43.61 | wps 24176 | wpb 510.9 | bsz 1 | num_updates 26614 | best_loss 5.83
2022-02-20 04:48:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 26614 updates
2022-02-20 04:48:59 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint34.pt
2022-02-20 04:49:06 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint34.pt
2022-02-20 04:49:15 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint34.pt (epoch 34 @ 26614 updates, score 5.84) (writing took 15.815798754803836 seconds)
2022-02-20 04:49:15 | INFO | fairseq_cli.train | end of epoch 34 (average epoch stats below)
2022-02-20 04:49:15 | INFO | train | epoch 034 | loss 5.044 | nll_loss 4.64 | ppl 24.93 | wps 10678.1 | ups 0.16 | wpb 65497.3 | bsz 127.9 | num_updates 26614 | lr 0.000193841 | gnorm 0.632 | loss_scale 8 | train_wall 4563 | gb_free 3.3 | wall 159942
2022-02-20 04:49:15 | INFO | fairseq.trainer | begin training epoch 35
2022-02-20 04:49:15 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-20 04:57:56 | INFO | train_inner | epoch 035:     86 / 788 loss=4.967, nll_loss=4.561, ppl=23.6, wps=10376.4, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=26700, lr=0.000193528, gnorm=0.627, loss_scale=16, train_wall=577, gb_free=3.3, wall=160464
2022-02-20 05:07:45 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 05:08:09 | INFO | train_inner | epoch 035:    187 / 788 loss=4.991, nll_loss=4.586, ppl=24.01, wps=10701.9, ups=0.16, wpb=65536, bsz=128, num_updates=26800, lr=0.000193167, gnorm=0.641, loss_scale=16, train_wall=585, gb_free=3.3, wall=161076
2022-02-20 05:08:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 05:18:21 | INFO | train_inner | epoch 035:    288 / 788 loss=5.003, nll_loss=4.597, ppl=24.21, wps=10705, ups=0.16, wpb=65534.7, bsz=128, num_updates=26900, lr=0.000192807, gnorm=0.637, loss_scale=8, train_wall=585, gb_free=3.3, wall=161688
2022-02-20 05:25:07 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 05:28:33 | INFO | train_inner | epoch 035:    389 / 788 loss=5.032, nll_loss=4.628, ppl=24.72, wps=10706.7, ups=0.16, wpb=65536, bsz=128, num_updates=27000, lr=0.00019245, gnorm=0.629, loss_scale=8, train_wall=585, gb_free=3.3, wall=162301
2022-02-20 05:38:39 | INFO | train_inner | epoch 035:    489 / 788 loss=5.039, nll_loss=4.634, ppl=24.83, wps=10819, ups=0.17, wpb=65536, bsz=128, num_updates=27100, lr=0.000192095, gnorm=0.638, loss_scale=16, train_wall=579, gb_free=3.3, wall=162906
2022-02-20 05:40:51 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 05:48:45 | INFO | train_inner | epoch 035:    590 / 788 loss=5.066, nll_loss=4.663, ppl=25.33, wps=10811.3, ups=0.16, wpb=65536, bsz=128, num_updates=27200, lr=0.000191741, gnorm=0.644, loss_scale=8, train_wall=580, gb_free=3.3, wall=163513
2022-02-20 05:56:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 05:58:51 | INFO | train_inner | epoch 035:    691 / 788 loss=5.072, nll_loss=4.668, ppl=25.43, wps=10808.8, ups=0.16, wpb=65536, bsz=128, num_updates=27300, lr=0.00019139, gnorm=0.648, loss_scale=8, train_wall=580, gb_free=3.3, wall=164119
2022-02-20 06:08:31 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-20 06:08:40 | INFO | valid | epoch 035 | valid on 'valid' subset | loss 5.843 | nll_loss 5.449 | ppl 43.7 | wps 24321.1 | wpb 510.9 | bsz 1 | num_updates 27397 | best_loss 5.83
2022-02-20 06:08:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 35 @ 27397 updates
2022-02-20 06:08:40 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint35.pt
2022-02-20 06:08:46 | INFO | fairseq.trainer | Finished saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint35.pt
2022-02-20 06:08:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint35.pt (epoch 35 @ 27397 updates, score 5.843) (writing took 13.876771482639015 seconds)
2022-02-20 06:08:54 | INFO | fairseq_cli.train | end of epoch 35 (average epoch stats below)
2022-02-20 06:08:54 | INFO | train | epoch 035 | loss 5.033 | nll_loss 4.629 | ppl 24.74 | wps 10731.1 | ups 0.16 | wpb 65497.3 | bsz 127.9 | num_updates 27397 | lr 0.000191051 | gnorm 0.636 | loss_scale 8 | train_wall 4548 | gb_free 3.3 | wall 164721
2022-02-20 06:08:54 | INFO | fairseq.trainer | begin training epoch 36
2022-02-20 06:08:54 | INFO | fairseq_cli.train | Start iterating over samples
2022-02-20 06:09:12 | INFO | train_inner | epoch 036:      3 / 788 loss=5.101, nll_loss=4.699, ppl=25.97, wps=10512.6, ups=0.16, wpb=65233.9, bsz=127.4, num_updates=27400, lr=0.00019104, gnorm=0.625, loss_scale=8, train_wall=572, gb_free=3.3, wall=164739
2022-02-20 06:19:12 | INFO | train_inner | epoch 036:    103 / 788 loss=4.948, nll_loss=4.541, ppl=23.28, wps=10913.3, ups=0.17, wpb=65536, bsz=128, num_updates=27500, lr=0.000190693, gnorm=0.629, loss_scale=16, train_wall=575, gb_free=3.3, wall=165340
2022-02-20 06:22:31 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-02-20 06:28:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 06:29:25 | INFO | train_inner | epoch 036:    205 / 788 loss=4.974, nll_loss=4.567, ppl=23.71, wps=10705.1, ups=0.16, wpb=65536, bsz=128, num_updates=27600, lr=0.000190347, gnorm=0.62, loss_scale=8, train_wall=586, gb_free=3.3, wall=165952
2022-02-20 06:39:25 | INFO | train_inner | epoch 036:    305 / 788 loss=5.008, nll_loss=4.603, ppl=24.3, wps=10914.5, ups=0.17, wpb=65536, bsz=128, num_updates=27700, lr=0.000190003, gnorm=0.637, loss_scale=8, train_wall=574, gb_free=3.3, wall=166553
2022-02-20 06:44:49 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 06:49:32 | INFO | train_inner | epoch 036:    406 / 788 loss=5.015, nll_loss=4.61, ppl=24.42, wps=10807.7, ups=0.16, wpb=65536, bsz=128, num_updates=27800, lr=0.000189661, gnorm=0.635, loss_scale=8, train_wall=580, gb_free=3.3, wall=167159
2022-02-20 06:59:36 | INFO | train_inner | epoch 036:    506 / 788 loss=5.045, nll_loss=4.641, ppl=24.96, wps=10841.4, ups=0.17, wpb=65536, bsz=128, num_updates=27900, lr=0.000189321, gnorm=0.634, loss_scale=16, train_wall=576, gb_free=3.3, wall=167763
2022-02-20 07:05:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 07:09:47 | INFO | train_inner | epoch 036:    607 / 788 loss=5.054, nll_loss=4.649, ppl=25.1, wps=10726.6, ups=0.16, wpb=65534.7, bsz=128, num_updates=28000, lr=0.000188982, gnorm=0.655, loss_scale=8, train_wall=584, gb_free=3.3, wall=168374
2022-02-20 07:19:48 | INFO | train_inner | epoch 036:    707 / 788 loss=5.068, nll_loss=4.665, ppl=25.37, wps=10908.4, ups=0.17, wpb=65536, bsz=128, num_updates=28100, lr=0.000188646, gnorm=0.629, loss_scale=16, train_wall=575, gb_free=3.3, wall=168975
2022-02-20 07:23:38 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-02-20 07:27:55 | INFO | fairseq_cli.train | begin validation on "valid" subset
2022-02-20 07:28:04 | INFO | valid | epoch 036 | valid on 'valid' subset | loss 5.846 | nll_loss 5.455 | ppl 43.87 | wps 25166.1 | wpb 510.9 | bsz 1 | num_updates 28180 | best_loss 5.83
2022-02-20 07:28:04 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 28180 updates
2022-02-20 07:28:04 | INFO | fairseq.trainer | Saving checkpoint to /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1/checkpoint36.pt
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 29439616 vs 29439504
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x2b83709f16a7 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1c99500 (0x2b82d798a500 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x1c956d3 (0x2b82d79866d3 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x2b82d798b609 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x2b82d798c141 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x2b82d798c935 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x6543f3 (0x2b82d4e5c3f3 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x2c2c60 (0x2b82d4acac60 in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x2c3dce (0x2b82d4acbdce in /cluster/apps/nss/gcc-6.3.0/python_gpu/3.8.5/torch/lib/libtorch_python.so)
<omitting python frames>
frame #46: __libc_start_main + 0xf5 (0x2b82c2a43555 in /lib64/libc.so.6)
frame #47: /cluster/home/andriusb/fq/env/bin/python() [0x40071e]

/cluster/shadow/.lsbatch/1645168983.205633399: line 8: 64270 Aborted                 (core dumped) CUDA_VISIBLE_DEVICES=0 fairseq-train --task language_modeling data-bin/wikitext-103-raw-size-0.5 --save-dir /cluster/scratch/andriusb/checkpoints/w103_size_0.5_fp16-label_smoothing_0.02_#1 --arch transformer_lm --share-decoder-input-output-embed --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.02 --optimizer adam --adam-betas "(0.9, 0.98)" --weight-decay 0.01 --clip-norm 0.0 --lr 0.0005 --lr-scheduler inverse_sqrt --warmup-updates 4000 --warmup-init-lr 1e-07 --tokens-per-sample 512 --sample-break-mode none --max-tokens 512 --update-freq 128 --seed 1321671 --fp16 --max-update 50000
